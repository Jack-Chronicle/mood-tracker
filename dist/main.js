"use strict";var U=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var Q=Object.prototype.hasOwnProperty;var ee=(a,e)=>{for(var t in e)U(a,t,{get:e[t],enumerable:!0})},te=(a,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of J(e))!Q.call(a,o)&&o!==t&&U(a,o,{get:()=>e[o],enumerable:!(n=Z(e,o))||n.enumerable});return a};var oe=a=>te(U({},"__esModule",{value:!0}),a);var re={};ee(re,{default:()=>q});module.exports=oe(re);var X=require("obsidian");var k=require("obsidian"),j={moodsFilePath:"moods.txt",energyDisplay:"bar",energyFormat:"Energy: {value}",barIcons:"\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0",barIconCount:7,energyOnlyFormat:"Energy: {value}",moodOnlyFormat:"{value}",moodAndEnergyFormat:"{mood} | {energy}"};function N(a,e,t){if(!a||a.length<2||t<1)return e.toString();let n=a.length,o=Math.max(0,Math.min(100,e)),s="";for(let i=0;i<t;i++){let m=100*(i+1)/t,u=o-100*i/t,p=Math.round((1-u/(100/t))*(n-1));o>=m?p=0:o<=100*i/t&&(p=n-1),p=Math.max(0,Math.min(n-1,p)),s+=a[p]}return s}var I=null;function P(a){I&&I!==a&&I.remove(),I=a,document.body.appendChild(a)}function z(a){I===a?(a.remove(),I=null):a.remove()}var _=class{constructor(e,t){let n=[],o=null,s=-1,i=[],m="file-path-suggester-highlight";if(!document.getElementById("file-path-suggester-style")){let d=document.createElement("style");d.id="file-path-suggester-style",d.textContent=`
        .file-path-suggester-dropdown {
          background: var(--background-secondary);
          border: 1px solid var(--background-modifier-border);
          color: var(--text-normal);
          box-shadow: 0 2px 8px var(--background-modifier-box-shadow);
          border-radius: var(--radius-m);
          font-size: var(--font-ui-medium);
          padding: 4px 0;
        }
        .file-path-suggester-dropdown div {
          padding: 4px 12px;
          cursor: pointer;
          border-radius: var(--radius-s);
        }
        .file-path-suggester-dropdown div:hover,
        .file-path-suggester-highlight {
          background: var(--background-modifier-hover);
          color: var(--text-accent);
        }
      `,document.head.appendChild(d)}function u(){o&&z(o),o=null,i=[],s=-1}function p(d){if(u(),!d.length)return;o=document.createElement("div"),o.className="file-path-suggester-dropdown",o.style.position="absolute",o.style.zIndex="9999",o.style.maxHeight="200px",o.style.overflowY="auto",o.style.width=e.offsetWidth+"px";let b=e.getBoundingClientRect();o.style.left=b.left+window.scrollX+"px",o.style.top=b.bottom+window.scrollY+"px",d.forEach((E,S)=>{let h=document.createElement("div");h.textContent=E,h.tabIndex=-1,h.onmouseenter=()=>{g(S)},h.onmouseleave=()=>{g(-1)},h.onmousedown=x=>{x.preventDefault(),e.value=E,e.dispatchEvent(new Event("input")),u()},o.appendChild(h),i.push(h)}),P(o)}function g(d){i.forEach((b,E)=>{E===d?b.classList.add(m):b.classList.remove(m)}),s=d}e.addEventListener("input",()=>{let d=e.value.toLowerCase(),E=t.vault.getFiles().map(S=>S.path).filter(S=>S.toLowerCase().includes(d)).slice(0,20);n=E,p(E)}),e.addEventListener("keydown",d=>{!o||!i.length||(d.key==="ArrowDown"?(d.preventDefault(),g((s+1)%i.length),i[s]?.scrollIntoView({block:"nearest"})):d.key==="ArrowUp"?(d.preventDefault(),g((s-1+i.length)%i.length),i[s]?.scrollIntoView({block:"nearest"})):d.key==="Enter"?s>=0&&s<i.length&&(e.value=n[s],e.dispatchEvent(new Event("input")),u(),d.preventDefault()):d.key==="Escape"&&u())}),e.addEventListener("blur",()=>setTimeout(u,100))}},A=class extends k.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t,t.settingTab=this}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Mood & Energy Plugin Settings"}),e.createEl("h3",{text:"Mood Settings"}),new k.Setting(e).setName("Moods File Path").setDesc("Path to the file containing your moods, one per line (excluding frontmatter). Start typing to see suggestions from your vault.").addText(t=>{t.setPlaceholder("moods.txt").setValue(this.plugin.settings.moodsFilePath).onChange(async n=>{this.plugin.settings.moodsFilePath=n,await this.plugin.saveSettings()}),setTimeout(()=>new _(t.inputEl,this.app),0)}),e.createEl("h3",{text:"Energy Settings"}),new k.Setting(e).setName("Energy Display").setDesc("How to display the energy value: as text, percent, or a progress bar.").addDropdown(t=>t.addOption("text","Text").addOption("percent","Percent").addOption("bar","Progress Bar").setValue(this.plugin.settings.energyDisplay).onChange(async n=>{this.plugin.settings.energyDisplay=n,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.energyDisplay==="bar"&&(new k.Setting(e).setName("Bar Icons").setDesc("Icons for the progress bar, from full to empty (e.g. \u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0 or \u2588\u2593\u2592\u2591)").addText(t=>t.setPlaceholder("\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0").setValue(this.plugin.settings.barIcons).onChange(async n=>{this.plugin.settings.barIcons=n,await this.plugin.saveSettings()})),new k.Setting(e).setName("Bar Icon Count").setDesc("Number of icons in the progress bar (e.g. 5, 7, 10, 20)").addText(t=>t.setPlaceholder("7").setValue(this.plugin.settings.barIconCount.toString()).onChange(async n=>{let o=parseInt(n);!isNaN(o)&&o>0&&(this.plugin.settings.barIconCount=o,await this.plugin.saveSettings())}))),e.createEl("h3",{text:"Output Format Settings"}),new k.Setting(e).setName("Energy Only Output Format").setDesc("Format for energy only output. Use {value} for the energy bar/number.").addText(t=>t.setPlaceholder("Energy: {value}").setValue(this.plugin.settings.energyOnlyFormat).onChange(async n=>{this.plugin.settings.energyOnlyFormat=n,await this.plugin.saveSettings()})),new k.Setting(e).setName("Mood Only Output Format").setDesc("Format for mood only output. Use {value} for the mood.").addText(t=>t.setPlaceholder("{value}").setValue(this.plugin.settings.moodOnlyFormat).onChange(async n=>{this.plugin.settings.moodOnlyFormat=n,await this.plugin.saveSettings()})),new k.Setting(e).setName("Mood + Energy Output Format").setDesc("Format for mood + energy output. Use {mood} and {energy}.").addText(t=>t.setPlaceholder("{mood} | {energy}").setValue(this.plugin.settings.moodAndEnergyFormat).onChange(async n=>{this.plugin.settings.moodAndEnergyFormat=n,await this.plugin.saveSettings()}))}};async function K(a,e){try{let t=a.getAbstractFileByPath((0,k.normalizePath)(e));if(t instanceof k.TFile){let o=(await a.read(t)).split(/\r?\n/);if(o[0].trim()==="---"){let s=1;for(;s<o.length&&o[s].trim()!=="---";)s++;o=o.slice(s+1)}return o.map(s=>s.replace(/<\/?[a-zA-Z][^>]*>/g,"").trim()).filter(s=>s.length>0)}}catch(t){console.error("Failed to load moods file:",t)}return[]}var V=require("obsidian");var H=class a{constructor(e){this.selectedMood=null;this.resolveFn=null;this.moods=e}static parseMoodsToTree(e){let t={name:"",level:0,moods:[],sections:[]},n=t,o=[t];for(let s of e)if(/^#+\s/.test(s)){let i=s.match(/^(#+)\s*(.*)$/);if(!i)continue;let m=i[1].length,u=i[2].trim();for(;o.length>0&&o[o.length-1].level>=m;)o.pop();let p=o[o.length-1],g={name:u,level:m,moods:[],sections:[],parent:p};p.sections.push(g),o.push(g),n=g}else s.trim().length>0&&n.moods.push(s.replace(/^[-*]\s*/,""));return t}displayMenu(e){let t=document.createElement("div");t.className="mood-menu",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="var(--background-secondary)",t.style.padding="24px",t.style.borderRadius="var(--radius-m)",t.style.zIndex="9999",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",t.style.maxHeight="80vh",t.style.overflow="auto",t.style.width=e||"min(700px, 90vw)",t.style.minWidth="340px",t.style.maxWidth="98vw",t.style.border="var(--input-border-width) solid var(--background-modifier-border)";let n=a.parseMoodsToTree(this.moods),o=n,s=[],i=document.createElement("div");i.style.display="grid",i.style.gridTemplateColumns="repeat(auto-fit, minmax(220px, 1fr))",i.style.gap="18px",i.style.width="100%",i.style.marginBottom="18px";let m=document.createElement("div");m.style.display="none",m.style.flexDirection="column",m.style.alignItems="stretch",m.style.width="100%",m.style.marginBottom="18px";let u=document.createElement("button");u.innerText="\u2190 Back",u.className="mod-cta",u.style.marginBottom="12px",u.style.alignSelf="flex-start",u.style.padding="var(--size-4-2) var(--size-4-4)",u.style.borderRadius="var(--radius-s)",u.style.border="var(--input-border-width) solid var(--background-modifier-border)",u.style.background="var(--background-modifier-hover)",u.style.color="var(--text-normal)",u.style.fontWeight="bold",u.style.cursor="pointer",u.onclick=()=>{s.length>0&&(o=s.pop(),p(o))},m.appendChild(u);let p=h=>{if(h===n){i.style.display="grid",m.style.display="none",u.style.display="none",i.innerHTML="";let x=[...h.sections].sort((c,l)=>c.name.localeCompare(l.name)),v=[...h.moods].sort((c,l)=>c.localeCompare(l));if(x.forEach(c=>{let l=document.createElement("div");l.style.display="flex",l.style.flexDirection="column",l.style.alignItems="center",l.style.background="var(--background-modifier-hover)",l.style.borderRadius="var(--radius-m)",l.style.padding="18px 6px 18px 6px",l.style.boxSizing="border-box",l.style.minWidth="0",l.style.cursor="pointer",l.style.transition="background 0.2s",l.onmouseenter=()=>l.style.background="var(--background-modifier-active-hover)",l.onmouseleave=()=>l.style.background="var(--background-modifier-hover)";let r=document.createElement("div");r.innerText=c.name,r.style.fontWeight="bold",r.style.fontSize="1.2rem",r.style.color="var(--text-accent)",l.appendChild(r),l.onclick=()=>{s.push(h),o=c,p(c)},i.appendChild(l)}),x.length>0&&v.length>0){let c=document.createElement("div");c.style.gridColumn="1 / -1",c.style.height="1px",c.style.background="var(--background-modifier-border)",c.style.margin="12px 0",i.appendChild(c)}v.forEach(c=>{let l=document.createElement("button");l.innerText=c,l.className="mod-cta",l.style.padding="var(--size-4-2) var(--size-4-4)",l.style.borderRadius="var(--radius-s)",l.style.border="var(--input-border-width) solid var(--background-modifier-border)",l.style.background="var(--background-modifier-hover)",l.style.color="var(--text-normal)",l.style.fontSize="1rem",l.style.cursor="pointer",l.onmouseenter=()=>l.style.background="var(--background-modifier-active-hover)",l.onmouseleave=()=>l.style.background="var(--background-modifier-hover)",l.onclick=()=>{this.selectMood(c),Array.from(i.querySelectorAll("button")).forEach(r=>r.classList.remove("selected-mood")),l.classList.add("selected-mood"),this.confirmSelection()},i.appendChild(l)})}else{for(i.style.display="none",m.style.display="flex",u.style.display="block";m.childNodes.length>1;)m.removeChild(m.lastChild);let x=[...h.sections].sort((c,l)=>c.name.localeCompare(l.name)),v=[...h.moods].sort((c,l)=>c.localeCompare(l));if(x.length>0){let c=document.createElement("div");c.style.display="grid",c.style.gridTemplateColumns="repeat(auto-fit, minmax(180px, 1fr))",c.style.gap="12px",c.style.width="100%",x.forEach(l=>{let r=document.createElement("div");r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.background="var(--background-modifier-hover)",r.style.borderRadius="var(--radius-m)",r.style.padding="14px 4px 14px 4px",r.style.boxSizing="border-box",r.style.minWidth="0",r.style.cursor="pointer",r.style.transition="background 0.2s",r.onmouseenter=()=>r.style.background="var(--background-modifier-active-hover)",r.onmouseleave=()=>r.style.background="var(--background-modifier-hover)";let f=document.createElement("div");f.innerText=l.name,f.style.fontWeight="bold",f.style.fontSize="1.1rem",f.style.color="var(--text-accent)",r.appendChild(f),r.onclick=()=>{s.push(h),o=l,p(l)},c.appendChild(r)}),m.appendChild(c)}if(x.length>0&&v.length>0){let c=document.createElement("div");c.style.width="100%",c.style.height="1px",c.style.background="var(--background-modifier-border)",c.style.margin="12px 0",m.appendChild(c)}if(v.length>0){let c=document.createElement("div");c.style.display="grid",c.style.gridTemplateColumns="repeat(auto-fit, minmax(100px, 1fr))",c.style.gap="12px",c.style.width="100%",v.forEach(l=>{let r=document.createElement("button");r.innerText=l,r.className="mod-cta",r.style.padding="var(--size-4-2) var(--size-4-4)",r.style.borderRadius="var(--radius-s)",r.style.border="var(--input-border-width) solid var(--background-modifier-border)",r.style.background="var(--background-modifier-hover)",r.style.color="var(--text-normal)",r.style.fontSize="1rem",r.style.cursor="pointer",r.onmouseenter=()=>r.style.background="var(--background-modifier-active-hover)",r.onmouseleave=()=>r.style.background="var(--background-modifier-hover)",r.onclick=()=>{this.selectMood(l),Array.from(c.querySelectorAll("button")).forEach(f=>f.classList.remove("selected-mood")),r.classList.add("selected-mood"),this.confirmSelection()},c.appendChild(r)}),m.appendChild(c)}}};p(n),t.appendChild(i),t.appendChild(m);let g=document.createElement("div");g.style.display="flex",g.style.gap="12px",g.style.marginTop="10px";let d=document.createElement("button");d.innerText="Okay",d.className="mod-cta",d.style.padding="var(--size-4-2) var(--size-4-4)",d.style.borderRadius="var(--radius-s)",d.style.border="var(--input-border-width) solid var(--background-modifier-border)",d.style.background="var(--interactive-accent)",d.style.color="var(--text-on-accent)",d.style.fontWeight="bold",d.style.cursor="pointer",d.onclick=()=>this.confirmSelection(),g.appendChild(d);let b=document.createElement("button");b.innerText="Cancel",b.className="mod-cta",b.style.padding="var(--size-4-2) var(--size-4-4)",b.style.borderRadius="var(--radius-s)",b.style.border="var(--input-border-width) solid var(--background-modifier-border)",b.style.background="var(--background-modifier-hover)",b.style.color="var(--color-red)",b.style.fontWeight="bold",b.style.cursor="pointer",b.onclick=()=>this.cancelSelection(),g.appendChild(b),t.appendChild(g);let E=document.createElement("style");E.innerText=".selected-mood { background: var(--interactive-accent) !important; color: var(--text-on-accent) !important; border: var(--input-border-width) solid var(--background-primary) !important; }",t.appendChild(E);let S=h=>{h.key==="Escape"&&(m.style.display==="flex"&&s.length>0?(o=s.pop(),p(o)):(this.closeMenu(),window.removeEventListener("keydown",S)))};window.addEventListener("keydown",S),document.body.appendChild(t)}open(){return this.displayMenu(),new Promise(e=>{this.resolveFn=e})}selectMood(e){this.selectedMood=e}confirmSelection(){this.resolveFn&&this.resolveFn(this.selectedMood),this.closeMenu()}cancelSelection(){this.resolveFn&&this.resolveFn(null),this.closeMenu()}closeMenu(){let e=document.querySelector(".mood-menu");e&&e.remove()}};var R=class{constructor(e){this.resolveFn=null;this.selectedValue=50;this.plugin=e,this.createModal()}createModal(){this.modalElement=document.createElement("div"),this.modalElement.className="energy-slider-modal",this.modalElement.style.position="fixed",this.modalElement.style.top="50%",this.modalElement.style.left="50%",this.modalElement.style.transform="translate(-50%, -50%)",this.modalElement.style.background="var(--background-secondary)",this.modalElement.style.padding="24px",this.modalElement.style.borderRadius="var(--radius-m)",this.modalElement.style.zIndex="9999",this.modalElement.style.display="flex",this.modalElement.style.flexDirection="column",this.modalElement.style.alignItems="center",this.modalElement.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",this.modalElement.style.maxHeight="80vh",this.modalElement.style.overflow="auto",this.modalElement.style.minWidth="340px",this.modalElement.style.width="min(420px, 98vw)",this.modalElement.style.border="var(--input-border-width) solid var(--background-modifier-border)",this.modalElement.innerHTML=`
            <div class="slider-container" style="display:flex;flex-direction:column;align-items:center;">
                <input type="range" min="0" max="100" value="50" class="slider" id="energySlider" style="width:200px;">
                <div class="slider-value" id="sliderValue" style="margin-top:8px;color:var(--text-normal);">50</div>
                <div class="energy-preview" id="energyPreview" style="margin-top:8px;color:var(--text-normal);font-family:monospace;font-size:1.2em;"></div>
            </div>
            <div style="display:flex;gap:12px;margin-top:18px;justify-content:center;width:100%;">
                <button id="okayButton" class="mod-cta" style="padding:var(--size-4-2) var(--size-4-4);border-radius:var(--radius-s);border:var(--input-border-width) solid var(--background-modifier-border);background:var(--interactive-accent);color:var(--text-on-accent);font-weight:bold;cursor:pointer;">Okay</button>
                <button id="cancelButton" class="mod-cta" style="padding:var(--size-4-2) var(--size-4-4);border-radius:var(--radius-s);border:var(--input-border-width) solid var(--background-modifier-border);background:var(--background-modifier-hover);color:var(--color-red);font-weight:bold;cursor:pointer;">Cancel</button>
            </div>
        `,this.sliderElement=this.modalElement.querySelector("#energySlider");let e=this.modalElement.querySelector("#sliderValue"),t=this.modalElement.querySelector("#energyPreview"),n=this.modalElement.querySelector("#okayButton"),o=this.modalElement.querySelector("#cancelButton"),s=()=>{let m=this.plugin?.settings||{energyDisplay:"bar",energyFormat:"Energy: {value}",barIcons:"\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0",barIconCount:7,energyOnlyFormat:"Energy: {value}",moodOnlyFormat:"{value}",moodAndEnergyFormat:"{mood} | {energy}"},u=parseInt(this.sliderElement.value),p="";m.energyDisplay==="percent"?p=m.energyOnlyFormat.replace("{value}",`${u}%`):m.energyDisplay==="bar"?p=m.energyOnlyFormat.replace("{value}",N(m.barIcons,u,m.barIconCount)):p=m.energyOnlyFormat.replace("{value}",`${u}`),t.innerText=p};this.sliderElement.addEventListener("input",()=>{this.selectedValue=parseInt(this.sliderElement.value),e.textContent=this.selectedValue.toString(),s()}),s(),n.addEventListener("click",()=>{this.closeModal(),this.resolveFn&&this.resolveFn(this.selectedValue)}),o.addEventListener("click",()=>{this.closeModal(),this.resolveFn&&this.resolveFn(null)});let i=m=>{m.key==="Escape"&&(this.closeModal(),window.removeEventListener("keydown",i))};window.addEventListener("keydown",i)}open(){return P(this.modalElement),new Promise(e=>{this.resolveFn=e})}closeModal(){z(this.modalElement)}};function ne(a){let e=document.createElement("div");e.className="mood-energy-modal",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.background="var(--background-secondary)",e.style.padding="24px",e.style.borderRadius="var(--radius-m)",e.style.zIndex="9999",e.style.display="flex",e.style.flexDirection=window.innerWidth<600?"column":"row",e.style.alignItems="stretch",e.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",e.style.maxHeight=window.innerWidth<600?"98vh":"80vh",e.style.overflow="visible",e.style.width=window.innerWidth<600?"98vw":"min(900px, 98vw)",e.style.minWidth=window.innerWidth<600?"0":"340px",e.style.maxWidth="98vw",e.style.border="var(--input-border-width) solid var(--background-modifier-border)",window.innerWidth<600&&(e.style.width="98vw",e.style.minWidth="0",e.style.maxHeight="98vh",e.style.padding="8px",e.style.margin="0");let t=document.createElement("div");t.style.flex="1 1 0",t.style.overflowY="auto",t.style.maxHeight="calc(80vh - 24px)",t.style.marginRight="32px",t.style.background="var(--background-modifier-hover, rgba(255,255,255,0.01))",t.style.borderRadius="8px",t.style.padding="0 0 0 0",t.style.display="flex",t.style.flexDirection="column",t.style.minWidth=window.innerWidth<600?"0":"260px",window.innerWidth<600&&(t.style.marginRight="0",t.style.maxHeight="none",t.style.padding="0",t.style.width="100%",t.style.flex="1 1 auto");let n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.alignItems="center",n.style.justifyContent="flex-start",n.style.width=window.innerWidth<600?"100%":"320px",n.style.minWidth=window.innerWidth<600?"0":"220px",n.style.maxWidth=window.innerWidth<600?"100vw":"340px",n.style.background="var(--background-modifier-hover)",n.style.borderRadius="var(--radius-m)",n.style.padding=window.innerWidth<600?"12px":"18px 18px 18px 18px",n.style.boxSizing="border-box",n.style.height="100%",window.innerWidth<600&&(n.style.padding="12px 6px",n.style.minWidth="0",n.style.maxWidth="100vw");let o=document.createElement("div");o.innerText="Energy Level:",o.style.color="var(--text-normal, #fff)",o.style.marginBottom="8px";let s=document.createElement("input");s.type="range",s.min="0",s.max="100",s.value="50",s.style.width="220px",window.innerWidth<600&&(s.style.width="90vw");let i=document.createElement("div");i.innerText="50",i.style.color="var(--text-normal, #fff)",i.style.marginTop="8px";let m=document.createElement("div");m.style.marginTop="8px",m.style.color="var(--text-normal, #fff)",m.style.fontFamily="monospace",m.style.fontSize="1.2em";let u=()=>{let r=a.settings,f="",C=parseInt(s.value);r.energyDisplay==="percent"?f=r.energyOnlyFormat.replace("{value}",`${C}%`):r.energyDisplay==="bar"?f=r.energyOnlyFormat.replace("{value}",N(r.barIcons,C,r.barIconCount)):f=r.energyOnlyFormat.replace("{value}",`${C}`),m.innerText=f};s.oninput=()=>{i.innerText=s.value,u()},n.appendChild(o),n.appendChild(s),n.appendChild(i),n.appendChild(m),u();let p=document.createElement("div");p.style.display="flex",p.style.gap="12px",p.style.marginTop="18px",p.style.justifyContent="center",p.style.width="100%";let g=document.createElement("button");g.innerText="Okay",g.className="mod-cta",g.style.padding="var(--size-4-2) var(--size-4-4)",g.style.borderRadius="var(--radius-s)",g.style.border="var(--input-border-width) solid var(--background-modifier-border)",g.style.background="var(--interactive-accent)",g.style.color="var(--text-on-accent)",g.style.fontWeight="bold",g.style.cursor="pointer",window.innerWidth<600&&(g.style.fontSize="1.2em",g.style.padding="18px");let d=document.createElement("button");d.innerText="Cancel",d.className="mod-cta",d.style.padding="var(--size-4-2) var(--size-4-4)",d.style.borderRadius="var(--radius-s)",d.style.border="var(--input-border-width) solid var(--background-modifier-border)",d.style.background="var(--background-modifier-hover)",d.style.color="var(--color-red)",d.style.fontWeight="bold",d.style.cursor="pointer",p.appendChild(g),p.appendChild(d),n.appendChild(p);let b=null,E=null,S=[];window.innerWidth<600&&(d.style.fontSize="1.2em",d.style.padding="18px");let h=document.createElement("div");h.style.display="grid",h.style.gridTemplateColumns="repeat(auto-fit, minmax(180px, 1fr))",h.style.gap="18px",h.style.width="100%",h.style.minHeight="120px",h.style.boxSizing="border-box",h.style.marginBottom="18px";let x=document.createElement("div");x.style.display="none",x.style.flexDirection="column",x.style.alignItems="stretch",x.style.width="100%",x.style.marginBottom="18px";let v=document.createElement("button");v.innerText="\u2190 Back",v.style.margin="12px 0",v.style.padding=window.innerWidth<600?"10px 18px":"6px 16px",v.style.borderRadius="8px",v.style.border="none",v.style.background="var(--background-modifier-hover, #444)",v.style.color="var(--text-normal, #fff)",v.style.fontWeight="bold",v.style.fontSize=window.innerWidth<600?"1.1em":"1em",v.style.lineHeight="1.2",v.style.height="auto",v.style.display="block",v.style.verticalAlign="middle",v.style.alignSelf="stretch",v.style.textAlign="left",v.onclick=()=>{x.style.display="none",h.style.display="grid",v.style.display="none"},x.appendChild(v),v.style.display="none",K(a.app.vault,a.settings.moodsFilePath).then(r=>{S=r;let f={name:"__root__",level:0,moods:[],sections:[]},C=f,T=[f];for(let F of S)if(/^#+\s/.test(F)){let M=F.match(/^(#+)\s*(.*)$/);if(!M)continue;let L=M[1].length,G=M[2].trim();for(;T.length>0&&T[T.length-1].level>=L;)T.pop();let B=T[T.length-1],O={name:G,level:L,moods:[],sections:[],parent:B};B.sections.push(O),T.push(O),C=O}else F.trim().length>0&&C.moods.push(F.replace(/^[-*]\s*/,""));function $(F,M,L,G=[]){M.innerHTML="";let B=[...F.sections].sort((w,y)=>w.name.localeCompare(y.name)),O=[...F.moods].sort((w,y)=>w.localeCompare(y));if(B.forEach(w=>{let y=document.createElement("div");y.style.display="flex",y.style.flexDirection="column",y.style.alignItems="center",y.style.background="var(--background-modifier-hover, rgba(255,255,255,0.02))",y.style.borderRadius="8px",y.style.padding="18px 6px 18px 6px",y.style.boxSizing="border-box",y.style.minWidth="0",y.style.cursor="pointer",y.style.transition="background 0.2s",y.onmouseenter=()=>y.style.background="var(--background-modifier-active-hover, rgba(80,120,255,0.08))",y.onmouseleave=()=>y.style.background="var(--background-modifier-hover, rgba(255,255,255,0.02))";let D=document.createElement("div");D.innerText=w.name,D.style.fontWeight="bold",D.style.fontSize="1.2rem",D.style.color="var(--text-accent, #aaf)",y.appendChild(D),y.onclick=()=>{for(M.style.display="none",L.style.display="flex",v.style.display="block";L.childNodes.length>1;)L.removeChild(L.lastChild);let W=document.createElement("div");W.style.display="grid",W.style.gridTemplateColumns="repeat(auto-fit, minmax(100px, 1fr))",W.style.gap="12px",W.style.width="100%",$(w,W,L,[...G,w.name]),L.appendChild(W)},M.appendChild(y)}),B.length>0&&O.length>0){let w=document.createElement("div");w.style.gridColumn="1 / -1",w.style.height="1px",w.style.background="var(--background-modifier-border)",w.style.margin="12px 0",M.appendChild(w)}O.forEach(w=>{let y=document.createElement("button");y.innerText=w,y.style.padding="10px 18px",y.style.borderRadius="8px",y.style.border="none",y.style.background="var(--background-modifier-hover, #444)",y.style.color="var(--text-normal, #fff)",y.style.fontSize="1rem",y.style.cursor="pointer",y.onmouseenter=()=>y.style.background="var(--background-modifier-active-hover, #666)",y.onmouseleave=()=>y.style.background="var(--background-modifier-hover, #444)",y.onclick=()=>{b=w,Array.from(M.querySelectorAll("button")).forEach(D=>D.classList.remove("selected-mood")),y.classList.add("selected-mood"),E=y},M.appendChild(y)})}$(f,h,x)}),t.appendChild(h),t.appendChild(x);let c=document.createElement("style");c.innerText=".selected-mood { background: var(--interactive-accent) !important; color: var(--text-on-accent) !important; border: var(--input-border-width) solid var(--background-primary) !important; }",e.appendChild(c);let l=r=>{r.key==="Escape"&&(x.style.display==="flex"?(x.style.display="none",h.style.display="grid",v.style.display="none"):(z(e),window.removeEventListener("keydown",l)))};window.addEventListener("keydown",l),e.appendChild(t),e.appendChild(n),P(e),g.onclick=()=>{let r=a.app.workspace.getActiveViewOfType(V.MarkdownView)?.editor;if(r&&b){let f=a.settings,C="",T=parseInt(s.value);f.energyDisplay==="percent"?C=f.energyOnlyFormat.replace("{value}",`${T}%`):f.energyDisplay==="bar"?C=f.energyOnlyFormat.replace("{value}",N(f.barIcons,T,f.barIconCount)):C=f.energyOnlyFormat.replace("{value}",`${T}`);let F=(f.moodAndEnergyFormat||"{mood} | {energy}").replace("{mood}",b).replace("{energy}",C);r.replaceSelection(F),r.focus&&r.focus()}z(e)},d.onclick=()=>{z(e)}}function Y(a){function e(){return!I}a.addCommand({id:"insert-mood",name:"Insert Mood",hotkeys:[{modifiers:["Alt"],key:"6"}],callback:async()=>{if(!e())return;let t=await K(a.app.vault,a.settings.moodsFilePath),o=await new H(t).open();if(o){let s=a.app.workspace.getActiveViewOfType(V.MarkdownView)?.editor;if(s){let m=(a.settings.moodOnlyFormat||"{value}").replace("{value}",o);s.replaceSelection(m),s.focus&&s.focus()}}}}),a.addCommand({id:"insert-energy-level",name:"Insert Energy Level",hotkeys:[{modifiers:["Alt"],key:"5"}],callback:async()=>{if(!e())return;let n=await new R(a).open();if(n!==null){let o=a.app.workspace.getActiveViewOfType(V.MarkdownView)?.editor;if(o){let s="",i=a.settings;i.energyDisplay==="percent"?s=i.energyOnlyFormat.replace("{value}",`${n}%`):i.energyDisplay==="bar"?s=i.energyOnlyFormat.replace("{value}",N(i.barIcons,n,i.barIconCount)):s=i.energyOnlyFormat.replace("{value}",`${n}`),o.replaceSelection(s),o.focus&&o.focus()}}}}),a.addCommand({id:"insert-mood-and-energy",name:"Insert Mood and Energy Level",hotkeys:[{modifiers:["Alt"],key:"7"}],callback:()=>{e()&&ne(a)}})}var q=class extends X.Plugin{constructor(t,n){super(t,n);this.settingTab=null;this.settings=j}async onload(){this.settings=Object.assign({},j,await this.loadData?.()),this.addSettingTab(new A(this.app,this)),Y(this)}async saveSettings(){await this.saveData?.(this.settings)}onunload(){}};
//# sourceMappingURL=main.js.map
