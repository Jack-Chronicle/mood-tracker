"use strict";var j=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var ne=Object.prototype.hasOwnProperty;var se=(l,t)=>{for(var e in t)j(l,e,{get:t[e],enumerable:!0})},re=(l,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of oe(t))!ne.call(l,n)&&n!==e&&j(l,n,{get:()=>t[n],enumerable:!(o=te(t,n))||o.enumerable});return l};var ie=l=>re(j({},"__esModule",{value:!0}),l);var le={};se(le,{default:()=>G});module.exports=ie(le);var A=require("obsidian");var w=require("obsidian"),Y={moodsFilePath:"moods.txt",energyDisplay:"bar",energyFormat:"Energy: {value}",barIcons:"\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0",barIconCount:7,energyOnlyFormat:"Energy: {value}",moodOnlyFormat:"{value}",moodAndEnergyFormat:"{mood} | {energy}",showMoodRibbon:!0,showEnergyRibbon:!0,showCombinedRibbon:!0};function O(l,t,e){if(!l||l.length<2||e<1)return t.toString();let o=l.length,n=Math.max(0,Math.min(100,t)),s="";for(let a=0;a<e;a++){let m=100*(a+1)/e,p=n-100*a/e,u=Math.round((1-p/(100/e))*(o-1));n>=m?u=0:n<=100*a/e&&(u=o-1),u=Math.max(0,Math.min(o-1,u)),s+=l[u]}return s}var L=null;function P(l){L&&L!==l&&L.remove(),L=l,document.body.appendChild(l)}function R(l){L===l?(l.remove(),L=null):l.remove()}var K=class{constructor(t,e){let o=[],n=null,s=-1,a=[],m="file-path-suggester-highlight";if(!document.getElementById("file-path-suggester-style")){let d=document.createElement("style");d.id="file-path-suggester-style",d.textContent=`
        .file-path-suggester-dropdown {
          background: var(--background-secondary);
          border: 1px solid var(--background-modifier-border);
          color: var(--text-normal);
          box-shadow: 0 2px 8px var(--background-modifier-box-shadow);
          border-radius: var(--radius-m);
          font-size: var(--font-ui-medium);
          padding: 4px 0;
        }
        .file-path-suggester-dropdown div {
          padding: 4px 12px;
          cursor: pointer;
          border-radius: var(--radius-s);
        }
        .file-path-suggester-dropdown div:hover,
        .file-path-suggester-highlight {
          background: var(--background-modifier-hover);
          color: var(--text-accent);
        }
      `,document.head.appendChild(d)}function p(){n&&R(n),n=null,a=[],s=-1}function u(d){if(p(),!d.length)return;n=document.createElement("div"),n.className="file-path-suggester-dropdown",n.style.position="absolute",n.style.zIndex="9999",n.style.maxHeight="200px",n.style.overflowY="auto",n.style.width=t.offsetWidth+"px";let f=t.getBoundingClientRect();n.style.left=f.left+window.scrollX+"px",n.style.top=f.bottom+window.scrollY+"px",d.forEach((k,S)=>{let h=document.createElement("div");h.textContent=k,h.tabIndex=-1,h.onmouseenter=()=>{g(S)},h.onmouseleave=()=>{g(-1)},h.onmousedown=x=>{x.preventDefault(),t.value=k,t.dispatchEvent(new Event("input")),p()},n.appendChild(h),a.push(h)}),P(n)}function g(d){a.forEach((f,k)=>{k===d?f.classList.add(m):f.classList.remove(m)}),s=d}t.addEventListener("input",()=>{let d=t.value.toLowerCase(),k=e.vault.getFiles().map(S=>S.path).filter(S=>S.toLowerCase().includes(d)).slice(0,20);o=k,u(k)}),t.addEventListener("keydown",d=>{!n||!a.length||(d.key==="ArrowDown"?(d.preventDefault(),g((s+1)%a.length),a[s]?.scrollIntoView({block:"nearest"})):d.key==="ArrowUp"?(d.preventDefault(),g((s-1+a.length)%a.length),a[s]?.scrollIntoView({block:"nearest"})):d.key==="Enter"?s>=0&&s<a.length&&(t.value=o[s],t.dispatchEvent(new Event("input")),p(),d.preventDefault()):d.key==="Escape"&&p())}),t.addEventListener("blur",()=>setTimeout(p,100))}},$=class extends w.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e,e.settingTab=this}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Mood & Energy Plugin Settings"}),t.createEl("h3",{text:"Mood Settings"}),new w.Setting(t).setName("Moods File Path").setDesc("Path to the file containing your moods, one per line (excluding frontmatter). Start typing to see suggestions from your vault.").addText(e=>{e.setPlaceholder("moods.txt").setValue(this.plugin.settings.moodsFilePath).onChange(async o=>{this.plugin.settings.moodsFilePath=o,await this.plugin.saveSettings()}),setTimeout(()=>new K(e.inputEl,this.app),0)}),t.createEl("h3",{text:"Energy Settings"}),new w.Setting(t).setName("Energy Display").setDesc("How to display the energy value: as text, percent, or a progress bar.").addDropdown(e=>e.addOption("text","Text").addOption("percent","Percent").addOption("bar","Progress Bar").setValue(this.plugin.settings.energyDisplay).onChange(async o=>{this.plugin.settings.energyDisplay=o,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.energyDisplay==="bar"&&(new w.Setting(t).setName("Bar Icons").setDesc("Icons for the progress bar, from full to empty (e.g. \u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0 or \u2588\u2593\u2592\u2591)").addText(e=>e.setPlaceholder("\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0").setValue(this.plugin.settings.barIcons).onChange(async o=>{this.plugin.settings.barIcons=o,await this.plugin.saveSettings()})),new w.Setting(t).setName("Bar Icon Count").setDesc("Number of icons in the progress bar (e.g. 5, 7, 10, 20)").addText(e=>e.setPlaceholder("7").setValue(this.plugin.settings.barIconCount.toString()).onChange(async o=>{let n=parseInt(o);!isNaN(n)&&n>0&&(this.plugin.settings.barIconCount=n,await this.plugin.saveSettings())}))),t.createEl("h3",{text:"Output Format Settings"}),new w.Setting(t).setName("Energy Only Output Format").setDesc("Format for energy only output. Use {value} for the energy bar/number.").addText(e=>e.setPlaceholder("Energy: {value}").setValue(this.plugin.settings.energyOnlyFormat).onChange(async o=>{this.plugin.settings.energyOnlyFormat=o,await this.plugin.saveSettings()})),new w.Setting(t).setName("Mood Only Output Format").setDesc("Format for mood only output. Use {value} for the mood.").addText(e=>e.setPlaceholder("{value}").setValue(this.plugin.settings.moodOnlyFormat).onChange(async o=>{this.plugin.settings.moodOnlyFormat=o,await this.plugin.saveSettings()})),new w.Setting(t).setName("Mood + Energy Output Format").setDesc("Format for mood + energy output. Use {mood} and {energy}.").addText(e=>e.setPlaceholder("{mood} | {energy}").setValue(this.plugin.settings.moodAndEnergyFormat).onChange(async o=>{this.plugin.settings.moodAndEnergyFormat=o,await this.plugin.saveSettings()})),new w.Setting(t).setName("Show Mood Ribbon Icon").setDesc("Show a toolbar button for the Mood menu.").addToggle(e=>e.setValue(this.plugin.settings.showMoodRibbon).onChange(async o=>{this.plugin.settings.showMoodRibbon=o,await this.plugin.saveSettings(),this.plugin.reloadRibbonIcons()})),new w.Setting(t).setName("Show Energy Ribbon Icon").setDesc("Show a toolbar button for the Energy slider.").addToggle(e=>e.setValue(this.plugin.settings.showEnergyRibbon).onChange(async o=>{this.plugin.settings.showEnergyRibbon=o,await this.plugin.saveSettings(),this.plugin.reloadRibbonIcons()})),new w.Setting(t).setName("Show Combined Ribbon Icon").setDesc("Show a toolbar button for the combined Mood & Energy modal.").addToggle(e=>e.setValue(this.plugin.settings.showCombinedRibbon).onChange(async o=>{this.plugin.settings.showCombinedRibbon=o,await this.plugin.saveSettings(),this.plugin.reloadRibbonIcons()}))}};async function q(l,t){try{let e=l.getAbstractFileByPath((0,w.normalizePath)(t));if(e instanceof w.TFile){let n=(await l.read(e)).split(/\r?\n/);if(n[0].trim()==="---"){let s=1;for(;s<n.length&&n[s].trim()!=="---";)s++;n=n.slice(s+1)}return n.map(s=>s.replace(/<\/?[a-zA-Z][^>]*>/g,"").trim()).filter(s=>s.length>0)}}catch(e){console.error("Failed to load moods file:",e)}return[]}var W=require("obsidian");var H=class l{constructor(t){this.selectedMood=null;this.resolveFn=null;this.moods=t}static parseMoodsToTree(t){let e={name:"",level:0,moods:[],sections:[]},o=e,n=[e];for(let s of t)if(/^#+\s/.test(s)){let a=s.match(/^(#+)\s*(.*)$/);if(!a)continue;let m=a[1].length,p=a[2].trim();for(;n.length>0&&n[n.length-1].level>=m;)n.pop();let u=n[n.length-1],g={name:p,level:m,moods:[],sections:[],parent:u};u.sections.push(g),n.push(g),o=g}else s.trim().length>0&&o.moods.push(s.replace(/^[-*]\s*/,""));return e}displayMenu(t){let e=document.createElement("div");e.className="mood-menu",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.background="var(--background-secondary)",e.style.padding="24px",e.style.borderRadius="var(--radius-m)",e.style.zIndex="9999",e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="center",e.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",e.style.maxHeight="80vh",e.style.overflow="auto",e.style.width=t||"min(700px, 90vw)",e.style.minWidth="340px",e.style.maxWidth="98vw",e.style.border="var(--input-border-width) solid var(--background-modifier-border)";let o=l.parseMoodsToTree(this.moods),n=o,s=[],a=document.createElement("div");a.style.display="grid",a.style.gridTemplateColumns="repeat(auto-fit, minmax(220px, 1fr))",a.style.gap="18px",a.style.width="100%",a.style.marginBottom="18px";let m=document.createElement("div");m.style.display="none",m.style.flexDirection="column",m.style.alignItems="stretch",m.style.width="100%",m.style.marginBottom="18px";let p=document.createElement("button");p.innerText="\u2190 Back",p.className="mod-cta",p.style.marginBottom="12px",p.style.alignSelf="flex-start",p.style.padding="var(--size-4-2) var(--size-4-4)",p.style.borderRadius="var(--radius-s)",p.style.border="var(--input-border-width) solid var(--background-modifier-border)",p.style.background="var(--background-modifier-hover)",p.style.color="var(--text-normal)",p.style.fontWeight="bold",p.style.cursor="pointer",p.onclick=()=>{s.length>0&&(n=s.pop(),u(n))},m.appendChild(p);let u=h=>{if(h===o){a.style.display="grid",m.style.display="none",p.style.display="none",a.innerHTML="";let x=[...h.sections].sort((c,i)=>c.name.localeCompare(i.name)),v=[...h.moods].sort((c,i)=>c.localeCompare(i));if(x.forEach(c=>{let i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.alignItems="center",i.style.background="var(--background-modifier-hover)",i.style.borderRadius="var(--radius-m)",i.style.padding="18px 6px 18px 6px",i.style.boxSizing="border-box",i.style.minWidth="0",i.style.cursor="pointer",i.style.transition="background 0.2s",i.onmouseenter=()=>i.style.background="var(--background-modifier-active-hover)",i.onmouseleave=()=>i.style.background="var(--background-modifier-hover)";let r=document.createElement("div");r.innerText=c.name,r.style.fontWeight="bold",r.style.fontSize="1.2rem",r.style.color="var(--text-accent)",i.appendChild(r),i.onclick=()=>{s.push(h),n=c,u(c)},a.appendChild(i)}),x.length>0&&v.length>0){let c=document.createElement("div");c.style.gridColumn="1 / -1",c.style.height="1px",c.style.background="var(--background-modifier-border)",c.style.margin="12px 0",a.appendChild(c)}v.forEach(c=>{let i=document.createElement("button");i.innerText=c,i.className="mod-cta",i.style.padding="var(--size-4-2) var(--size-4-4)",i.style.borderRadius="var(--radius-s)",i.style.border="var(--input-border-width) solid var(--background-modifier-border)",i.style.background="var(--background-modifier-hover)",i.style.color="var(--text-normal)",i.style.fontSize="1rem",i.style.cursor="pointer",i.style.whiteSpace="normal",i.style.overflow="hidden",i.style.wordBreak="normal",i.style.textOverflow="ellipsis",i.style.height="auto",i.style.minHeight="48px",i.style.display="block",i.style.width="100%",i.onmouseenter=()=>i.style.background="var(--background-modifier-active-hover)",i.onmouseleave=()=>i.style.background="var(--background-modifier-hover)",i.onclick=()=>{this.selectMood(c),Array.from(a.querySelectorAll("button")).forEach(r=>r.classList.remove("selected-mood")),i.classList.add("selected-mood"),this.confirmSelection()},a.appendChild(i)})}else{for(a.style.display="none",m.style.display="flex",p.style.display="block";m.childNodes.length>1;)m.removeChild(m.lastChild);let x=[...h.sections].sort((c,i)=>c.name.localeCompare(i.name)),v=[...h.moods].sort((c,i)=>c.localeCompare(i));if(x.length>0){let c=document.createElement("div");c.style.display="grid",c.style.gridTemplateColumns="repeat(auto-fit, minmax(180px, 1fr))",c.style.gap="12px",c.style.width="100%",x.forEach(i=>{let r=document.createElement("div");r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.background="var(--background-modifier-hover)",r.style.borderRadius="var(--radius-m)",r.style.padding="14px 4px 14px 4px",r.style.boxSizing="border-box",r.style.minWidth="0",r.style.cursor="pointer",r.style.transition="background 0.2s",r.onmouseenter=()=>r.style.background="var(--background-modifier-active-hover)",r.onmouseleave=()=>r.style.background="var(--background-modifier-hover)";let b=document.createElement("div");b.innerText=i.name,b.style.fontWeight="bold",b.style.fontSize="1.1rem",b.style.color="var(--text-accent)",r.appendChild(b),r.onclick=()=>{s.push(h),n=i,u(i)},c.appendChild(r)}),m.appendChild(c)}if(x.length>0&&v.length>0){let c=document.createElement("div");c.style.width="100%",c.style.height="1px",c.style.background="var(--background-modifier-border)",c.style.margin="12px 0",m.appendChild(c)}if(v.length>0){let c=document.createElement("div");c.style.display="grid",c.style.gridTemplateColumns="repeat(auto-fit, minmax(100px, 1fr))",c.style.gap="12px",c.style.width="100%",v.forEach(i=>{let r=document.createElement("button");r.innerText=i,r.className="mod-cta",r.style.padding="var(--size-4-2) var(--size-4-4)",r.style.borderRadius="var(--radius-s)",r.style.border="var(--input-border-width) solid var(--background-modifier-border)",r.style.background="var(--background-modifier-hover)",r.style.color="var(--text-normal)",r.style.fontSize="1rem",r.style.cursor="pointer",r.style.whiteSpace="normal",r.style.overflow="hidden",r.style.wordBreak="normal",r.style.textOverflow="ellipsis",r.style.height="auto",r.style.minHeight="48px",r.style.display="block",r.style.width="100%",r.onmouseenter=()=>r.style.background="var(--background-modifier-active-hover)",r.onmouseleave=()=>r.style.background="var(--background-modifier-hover)",r.onclick=()=>{this.selectMood(i),Array.from(c.querySelectorAll("button")).forEach(b=>b.classList.remove("selected-mood")),r.classList.add("selected-mood"),this.confirmSelection()},c.appendChild(r)}),m.appendChild(c)}}};u(o),e.appendChild(a),e.appendChild(m);let g=document.createElement("div");g.style.display="flex",g.style.gap="12px",g.style.marginTop="10px";let d=document.createElement("button");d.innerText="Okay",d.className="mod-cta",d.style.padding="var(--size-4-2) var(--size-4-4)",d.style.borderRadius="var(--radius-s)",d.style.border="var(--input-border-width) solid var(--background-modifier-border)",d.style.background="var(--interactive-accent)",d.style.color="var(--text-on-accent)",d.style.fontWeight="bold",d.style.cursor="pointer",d.onclick=()=>this.confirmSelection(),g.appendChild(d);let f=document.createElement("button");f.innerText="Cancel",f.className="mod-cta",f.style.padding="var(--size-4-2) var(--size-4-4)",f.style.borderRadius="var(--radius-s)",f.style.border="var(--input-border-width) solid var(--background-modifier-border)",f.style.background="var(--background-modifier-hover)",f.style.color="var(--color-red)",f.style.fontWeight="bold",f.style.cursor="pointer",f.onclick=()=>this.cancelSelection(),g.appendChild(f),e.appendChild(g);let k=document.createElement("style");k.innerText=".selected-mood { background: var(--interactive-accent) !important; color: var(--text-on-accent) !important; border: var(--input-border-width) solid var(--background-primary) !important; }",e.appendChild(k);let S=h=>{h.key==="Escape"&&(m.style.display==="flex"&&s.length>0?(n=s.pop(),u(n)):(this.closeMenu(),window.removeEventListener("keydown",S)))};window.addEventListener("keydown",S),document.body.appendChild(e)}open(){return this.displayMenu(),new Promise(t=>{this.resolveFn=t})}selectMood(t){this.selectedMood=t}confirmSelection(){this.resolveFn&&this.resolveFn(this.selectedMood),this.closeMenu()}cancelSelection(){this.resolveFn&&this.resolveFn(null),this.closeMenu()}closeMenu(){let t=document.querySelector(".mood-menu");t&&t.remove()}};var V=class{constructor(t){this.resolveFn=null;this.selectedValue=50;this.plugin=t,this.createModal()}createModal(){this.modalElement=document.createElement("div"),this.modalElement.className="energy-slider-modal",this.modalElement.style.position="fixed",this.modalElement.style.top="50%",this.modalElement.style.left="50%",this.modalElement.style.transform="translate(-50%, -50%)",this.modalElement.style.background="var(--background-secondary)",this.modalElement.style.padding="24px",this.modalElement.style.borderRadius="var(--radius-m)",this.modalElement.style.zIndex="9999",this.modalElement.style.display="flex",this.modalElement.style.flexDirection="column",this.modalElement.style.alignItems="center",this.modalElement.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",this.modalElement.style.maxHeight="80vh",this.modalElement.style.overflow="auto",this.modalElement.style.minWidth="340px",this.modalElement.style.width="min(420px, 98vw)",this.modalElement.style.border="var(--input-border-width) solid var(--background-modifier-border)",this.modalElement.innerHTML=`
            <div class="slider-container" style="display:flex;flex-direction:column;align-items:center;">
                <input type="range" min="0" max="100" value="50" class="slider" id="energySlider" style="width:200px;">
                <div class="slider-value" id="sliderValue" style="margin-top:8px;color:var(--text-normal);">50</div>
                <div class="energy-preview" id="energyPreview" style="margin-top:8px;color:var(--text-normal);font-family:monospace;font-size:1.2em;"></div>
            </div>
            <div style="display:flex;gap:12px;margin-top:18px;justify-content:center;width:100%;">
                <button id="okayButton" class="mod-cta" style="padding:var(--size-4-2) var(--size-4-4);border-radius:var(--radius-s);border:var(--input-border-width) solid var(--background-modifier-border);background:var(--interactive-accent);color:var(--text-on-accent);font-weight:bold;cursor:pointer;">Okay</button>
                <button id="cancelButton" class="mod-cta" style="padding:var(--size-4-2) var(--size-4-4);border-radius:var(--radius-s);border:var(--input-border-width) solid var(--background-modifier-border);background:var(--background-modifier-hover);color:var(--color-red);font-weight:bold;cursor:pointer;">Cancel</button>
            </div>
        `,this.sliderElement=this.modalElement.querySelector("#energySlider");let t=this.modalElement.querySelector("#sliderValue"),e=this.modalElement.querySelector("#energyPreview"),o=this.modalElement.querySelector("#okayButton"),n=this.modalElement.querySelector("#cancelButton"),s=()=>{let m=this.plugin?.settings||{energyDisplay:"bar",energyFormat:"Energy: {value}",barIcons:"\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0",barIconCount:7,energyOnlyFormat:"Energy: {value}",moodOnlyFormat:"{value}",moodAndEnergyFormat:"{mood} | {energy}"},p=parseInt(this.sliderElement.value),u="";m.energyDisplay==="percent"?u=m.energyOnlyFormat.replace("{value}",`${p}%`):m.energyDisplay==="bar"?u=m.energyOnlyFormat.replace("{value}",O(m.barIcons,p,m.barIconCount)):u=m.energyOnlyFormat.replace("{value}",`${p}`),e.innerText=u};this.sliderElement.addEventListener("input",()=>{this.selectedValue=parseInt(this.sliderElement.value),t.textContent=this.selectedValue.toString(),s()}),s(),o.addEventListener("click",()=>{this.closeModal(),this.resolveFn&&this.resolveFn(this.selectedValue)}),n.addEventListener("click",()=>{this.closeModal(),this.resolveFn&&this.resolveFn(null)});let a=m=>{m.key==="Escape"&&(this.closeModal(),window.removeEventListener("keydown",a))};window.addEventListener("keydown",a)}open(){return P(this.modalElement),new Promise(t=>{this.resolveFn=t})}closeModal(){R(this.modalElement)}};async function X(l){let t=await q(l.app.vault,l.settings.moodsFilePath),o=await new H(t).open();if(o){let n=l.app.workspace.getActiveViewOfType(W.MarkdownView)?.editor;if(n){let a=(l.settings.moodOnlyFormat||"{value}").replace("{value}",o);n.focus(),n.replaceSelection(a)}}}async function Z(l){let e=await new V(l).open();if(e!==null){let o=l.app.workspace.getActiveViewOfType(W.MarkdownView)?.editor;if(o){let n="",s=l.settings;s.energyDisplay==="percent"?n=s.energyOnlyFormat.replace("{value}",`${e}%`):s.energyDisplay==="bar"?n=s.energyOnlyFormat.replace("{value}",O(s.barIcons,e,s.barIconCount)):n=s.energyOnlyFormat.replace("{value}",`${e}`),o.focus(),o.replaceSelection(n)}}}async function J(l){Q(l)}function Q(l){let t=document.createElement("div");t.className="mood-energy-modal",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="var(--background-secondary)",t.style.padding="24px",t.style.borderRadius="var(--radius-m)",t.style.zIndex="9999",t.style.display="flex",t.style.flexDirection=window.innerWidth<600?"column":"row",t.style.alignItems="stretch",t.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",t.style.maxHeight=window.innerWidth<600?"98vh":"80vh",t.style.overflow="visible",t.style.width=window.innerWidth<600?"98vw":"min(900px, 98vw)",t.style.minWidth=window.innerWidth<600?"0":"340px",t.style.maxWidth="98vw",t.style.border="var(--input-border-width) solid var(--background-modifier-border)",window.innerWidth<600&&(t.style.width="98vw",t.style.minWidth="0",t.style.maxHeight="98vh",t.style.padding="8px",t.style.margin="0");let e=document.createElement("div");e.style.flex="1 1 0",e.style.overflowY="auto",e.style.maxHeight="calc(80vh - 24px)",e.style.marginRight="32px",e.style.background="var(--background-modifier-hover, rgba(255,255,255,0.01))",e.style.borderRadius="8px",e.style.padding="0 0 0 0",e.style.display="flex",e.style.flexDirection="column",e.style.minWidth=window.innerWidth<600?"0":"260px",window.innerWidth<600&&(e.style.marginRight="0",e.style.maxHeight="none",e.style.padding="0",e.style.width="100%",e.style.flex="1 1 auto");let o=document.createElement("div");o.style.display="flex",o.style.flexDirection="column",o.style.alignItems="center",o.style.justifyContent="flex-start",o.style.width=window.innerWidth<600?"100%":"320px",o.style.minWidth=window.innerWidth<600?"0":"220px",o.style.maxWidth=window.innerWidth<600?"100vw":"340px",o.style.background="var(--background-modifier-hover)",o.style.borderRadius="var(--radius-m)",o.style.padding=window.innerWidth<600?"12px":"18px 18px 18px 18px",o.style.boxSizing="border-box",o.style.height="100%",window.innerWidth<600&&(o.style.padding="12px 6px",o.style.minWidth="0",o.style.maxWidth="100vw");let n=document.createElement("div");n.innerText="Energy Level:",n.style.color="var(--text-normal, #fff)",n.style.marginBottom="8px";let s=document.createElement("input");s.type="range",s.min="0",s.max="100",s.value="50",s.style.width="220px",window.innerWidth<600&&(s.style.width="90vw");let a=document.createElement("div");a.innerText="50",a.style.color="var(--text-normal, #fff)",a.style.marginTop="8px";let m=document.createElement("div");m.style.marginTop="8px",m.style.color="var(--text-normal, #fff)",m.style.fontFamily="monospace",m.style.fontSize="1.2em";let p=()=>{let r=l.settings,b="",M=parseInt(s.value);r.energyDisplay==="percent"?b=r.energyOnlyFormat.replace("{value}",`${M}%`):r.energyDisplay==="bar"?b=r.energyOnlyFormat.replace("{value}",O(r.barIcons,M,r.barIconCount)):b=r.energyOnlyFormat.replace("{value}",`${M}`),m.innerText=b};s.oninput=()=>{a.innerText=s.value,p()},o.appendChild(n),o.appendChild(s),o.appendChild(a),o.appendChild(m),p();let u=document.createElement("div");u.style.display="flex",u.style.gap="12px",u.style.marginTop="18px",u.style.justifyContent="center",u.style.width="100%";let g=document.createElement("button");g.innerText="Okay",g.className="mod-cta",g.style.padding="var(--size-4-2) var(--size-4-4)",g.style.borderRadius="var(--radius-s)",g.style.border="var(--input-border-width) solid var(--background-modifier-border)",g.style.background="var(--interactive-accent)",g.style.color="var(--text-on-accent)",g.style.fontWeight="bold",g.style.cursor="pointer",window.innerWidth<600&&(g.style.fontSize="1.2em",g.style.padding="18px");let d=document.createElement("button");d.innerText="Cancel",d.className="mod-cta",d.style.padding="var(--size-4-2) var(--size-4-4)",d.style.borderRadius="var(--radius-s)",d.style.border="var(--input-border-width) solid var(--background-modifier-border)",d.style.background="var(--background-modifier-hover)",d.style.color="var(--color-red)",d.style.fontWeight="bold",d.style.cursor="pointer",u.appendChild(g),u.appendChild(d),o.appendChild(u);let f=null,k=null,S=[];window.innerWidth<600&&(d.style.fontSize="1.2em",d.style.padding="18px");let h=document.createElement("div");h.style.display="grid",h.style.gridTemplateColumns="repeat(auto-fit, minmax(180px, 1fr))",h.style.gap="18px",h.style.width="100%",h.style.minHeight="120px",h.style.boxSizing="border-box",h.style.marginBottom="18px";let x=document.createElement("div");x.style.display="none",x.style.flexDirection="column",x.style.alignItems="stretch",x.style.width="100%",x.style.marginBottom="18px";let v=document.createElement("button");v.innerText="\u2190 Back",v.style.margin="12px 0",v.style.padding=window.innerWidth<600?"10px 18px":"6px 16px",v.style.borderRadius="8px",v.style.border="none",v.style.background="var(--background-modifier-hover, #444)",v.style.color="var(--text-normal, #fff)",v.style.fontWeight="bold",v.style.fontSize=window.innerWidth<600?"1.1em":"1em",v.style.lineHeight="1.2",v.style.height="auto",v.style.display="block",v.style.verticalAlign="middle",v.style.alignSelf="stretch",v.style.textAlign="left",v.onclick=()=>{x.style.display="none",h.style.display="grid",v.style.display="none"},x.appendChild(v),v.style.display="none",q(l.app.vault,l.settings.moodsFilePath).then(r=>{S=r;let b={name:"__root__",level:0,moods:[],sections:[]},M=b,C=[b];for(let F of S)if(/^#+\s/.test(F)){let T=F.match(/^(#+)\s*(.*)$/);if(!T)continue;let I=T[1].length,_=T[2].trim();for(;C.length>0&&C[C.length-1].level>=I;)C.pop();let B=C[C.length-1],N={name:_,level:I,moods:[],sections:[],parent:B};B.sections.push(N),C.push(N),M=N}else F.trim().length>0&&M.moods.push(F.replace(/^[-*]\s*/,""));function U(F,T,I,_=[]){T.innerHTML="";let B=[...F.sections].sort((E,y)=>E.name.localeCompare(y.name)),N=[...F.moods].sort((E,y)=>E.localeCompare(y));if(B.forEach(E=>{let y=document.createElement("div");y.style.display="flex",y.style.flexDirection="column",y.style.alignItems="center",y.style.background="var(--background-modifier-hover, rgba(255,255,255,0.02))",y.style.borderRadius="8px",y.style.padding="18px 6px 18px 6px",y.style.boxSizing="border-box",y.style.minWidth="0",y.style.cursor="pointer",y.style.transition="background 0.2s",y.onmouseenter=()=>y.style.background="var(--background-modifier-active-hover, rgba(80,120,255,0.08))",y.onmouseleave=()=>y.style.background="var(--background-modifier-hover, rgba(255,255,255,0.02))";let D=document.createElement("div");D.innerText=E.name,D.style.fontWeight="bold",D.style.fontSize="1.2rem",D.style.color="var(--text-accent, #aaf)",y.appendChild(D),y.onclick=()=>{for(T.style.display="none",I.style.display="flex",v.style.display="block";I.childNodes.length>1;)I.removeChild(I.lastChild);let z=document.createElement("div");z.style.display="grid",z.style.gridTemplateColumns="repeat(auto-fit, minmax(100px, 1fr))",z.style.gap="12px",z.style.width="100%",U(E,z,I,[..._,E.name]),I.appendChild(z)},T.appendChild(y)}),B.length>0&&N.length>0){let E=document.createElement("div");E.style.gridColumn="1 / -1",E.style.height="1px",E.style.background="var(--background-modifier-border)",E.style.margin="12px 0",T.appendChild(E)}N.forEach(E=>{let y=document.createElement("button");y.innerText=E,y.style.padding="10px 18px",y.style.borderRadius="8px",y.style.border="none",y.style.background="var(--background-modifier-hover, #444)",y.style.color="var(--text-normal, #fff)",y.style.fontSize="1rem",y.style.cursor="pointer",y.onmouseenter=()=>y.style.background="var(--background-modifier-active-hover, #666)",y.onmouseleave=()=>y.style.background="var(--background-modifier-hover, #444)",y.onclick=()=>{f=E,Array.from(T.querySelectorAll("button")).forEach(D=>D.classList.remove("selected-mood")),y.classList.add("selected-mood"),k=y},T.appendChild(y)})}U(b,h,x)}),e.appendChild(h),e.appendChild(x);let c=document.createElement("style");c.innerText=".selected-mood { background: var(--interactive-accent) !important; color: var(--text-on-accent) !important; border: var(--input-border-width) solid var(--background-primary) !important; }",t.appendChild(c);let i=r=>{r.key==="Escape"&&(x.style.display==="flex"?(x.style.display="none",h.style.display="grid",v.style.display="none"):(R(t),window.removeEventListener("keydown",i)))};window.addEventListener("keydown",i),t.appendChild(e),t.appendChild(o),P(t),g.onclick=()=>{let r=l.app.workspace.getActiveViewOfType(W.MarkdownView)?.editor;if(r&&f){let b=l.settings,M="",C=parseInt(s.value);b.energyDisplay==="percent"?M=b.energyOnlyFormat.replace("{value}",`${C}%`):b.energyDisplay==="bar"?M=b.energyOnlyFormat.replace("{value}",O(b.barIcons,C,b.barIconCount)):M=b.energyOnlyFormat.replace("{value}",`${C}`);let F=(b.moodAndEnergyFormat||"{mood} | {energy}").replace("{mood}",f).replace("{energy}",M);typeof r.focus=="function"&&r.focus(),r.replaceSelection(F)}R(t)},d.onclick=()=>{R(t)}}function ee(l){function t(){return!L}l.addCommand({id:"insert-mood",name:"Insert Mood",hotkeys:[{modifiers:["Alt"],key:"6"}],callback:async()=>{if(!t())return;let e=await q(l.app.vault,l.settings.moodsFilePath),n=await new H(e).open();if(n){let s=l.app.workspace.getActiveViewOfType(W.MarkdownView)?.editor;if(s){let m=(l.settings.moodOnlyFormat||"{value}").replace("{value}",n);s.replaceSelection(m),s.focus&&s.focus()}}}}),l.addCommand({id:"insert-energy-level",name:"Insert Energy Level",hotkeys:[{modifiers:["Alt"],key:"5"}],callback:async()=>{if(!t())return;let o=await new V(l).open();if(o!==null){let n=l.app.workspace.getActiveViewOfType(W.MarkdownView)?.editor;if(n){let s="",a=l.settings;a.energyDisplay==="percent"?s=a.energyOnlyFormat.replace("{value}",`${o}%`):a.energyDisplay==="bar"?s=a.energyOnlyFormat.replace("{value}",O(a.barIcons,o,a.barIconCount)):s=a.energyOnlyFormat.replace("{value}",`${o}`),n.replaceSelection(s),n.focus&&n.focus()}}}}),l.addCommand({id:"insert-mood-and-energy",name:"Insert Mood and Energy Level",hotkeys:[{modifiers:["Alt"],key:"7"}],callback:()=>{t()&&Q(l)}})}var G=class extends A.Plugin{constructor(e,o){super(e,o);this.settingTab=null;this.ribbonIcons=[];this.settings=Y}reloadRibbonIcons(){if(this.ribbonIcons.forEach(e=>e.remove()),this.ribbonIcons=[],this.settings.showMoodRibbon){let e=this.addRibbonIcon("smile","Open Mood Menu",async()=>{let o=this.app.workspace.getActiveViewOfType(A.MarkdownView)?.editor;o&&o.focus(),await X(this)});this.ribbonIcons.push(e)}if(this.settings.showEnergyRibbon){let e=this.addRibbonIcon("activity","Open Energy Slider",async()=>{let o=this.app.workspace.getActiveViewOfType(A.MarkdownView)?.editor;o&&o.focus(),await Z(this)});this.ribbonIcons.push(e)}if(this.settings.showCombinedRibbon){let e=this.addRibbonIcon("bar-chart-2","Open Mood & Energy Modal",async()=>{let o=this.app.workspace.getActiveViewOfType(A.MarkdownView)?.editor;o&&o.focus(),await J(this)});this.ribbonIcons.push(e)}}async onload(){this.settings=Object.assign({},Y,await this.loadData?.()),await this.saveSettings(),this.addSettingTab(new $(this.app,this)),ee(this),await this.reloadRibbonIcons()}async saveSettings(){await this.saveData?.(this.settings)}onunload(){this.ribbonIcons.forEach(e=>e.remove()),this.ribbonIcons=[]}};
//# sourceMappingURL=main.js.map
