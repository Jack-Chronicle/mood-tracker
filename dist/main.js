"use strict";var A=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var j=(c,r)=>{for(var s in r)A(c,s,{get:r[s],enumerable:!0})},K=(c,r,s,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of G(r))!U.call(c,n)&&n!==s&&A(c,n,{get:()=>r[n],enumerable:!(t=q(r,n))||t.enumerable});return c};var Y=c=>K(A({},"__esModule",{value:!0}),c);var X={};j(X,{default:()=>z});module.exports=Y(X);var I=require("obsidian");var B={moodsFilePath:"moods.txt",energyDisplay:"bar",energyFormat:"Energy: {value}",barIcons:"\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0",barIconCount:7,energyOnlyFormat:"Energy: {value}",moodOnlyFormat:"{value}",moodAndEnergyFormat:"{mood} | {energy}",showMoodRibbon:!0,showEnergyRibbon:!0,showCombinedRibbon:!0};var R=require("obsidian"),x=require("obsidian");var L=class{constructor(r,s){let t=[],n=null,e=-1,o=[],l="file-path-suggester-highlight";if(!document.getElementById("file-path-suggester-style")){let y=document.createElement("style");y.id="file-path-suggester-style",y.textContent=`
        .file-path-suggester-dropdown {
          background: var(--background-secondary);
          border: 1px solid var(--background-modifier-border);
          color: var(--text-normal);
          box-shadow: 0 2px 8px var(--background-modifier-box-shadow);
          border-radius: var(--radius-m);
          font-size: var(--font-ui-medium);
          padding: 4px 0;
        }
        .file-path-suggester-dropdown div {
          padding: 4px 12px;
          cursor: pointer;
          border-radius: var(--radius-s);
        }
        .file-path-suggester-dropdown div:hover,
        .file-path-suggester-highlight {
          background: var(--background-modifier-hover);
          color: var(--text-accent);
        }
      `,document.head.appendChild(y)}function h(){n&&n.remove(),n=null,o=[],e=-1}function g(y){if(h(),!y.length)return;n=document.createElement("div"),n.className="file-path-suggester-dropdown",n.style.position="absolute",n.style.zIndex="9999",n.style.maxHeight="200px",n.style.overflowY="auto",n.style.width=r.offsetWidth+"px";let f=r.getBoundingClientRect();n.style.left=f.left+window.scrollX+"px",n.style.top=f.bottom+window.scrollY+"px",y.forEach((b,a)=>{let i=document.createElement("div");i.textContent=b,i.tabIndex=-1,i.onmouseenter=()=>v(a),i.onmouseleave=()=>v(-1),i.onmousedown=d=>{d.preventDefault(),r.value=b,r.dispatchEvent(new Event("input")),h()},n.appendChild(i),o.push(i)}),document.body.appendChild(n)}function v(y){o.forEach((f,b)=>{b===y?f.classList.add(l):f.classList.remove(l)}),e=y}r.addEventListener("input",()=>{let y=r.value.toLowerCase(),b=s.vault.getFiles().map(a=>a.path).filter(a=>a.toLowerCase().includes(y)).slice(0,20);t=b,g(b)}),r.addEventListener("keydown",y=>{!n||!o.length||(y.key==="ArrowDown"?(y.preventDefault(),v((e+1)%o.length),o[e]?.scrollIntoView({block:"nearest"})):y.key==="ArrowUp"?(y.preventDefault(),v((e-1+o.length)%o.length),o[e]?.scrollIntoView({block:"nearest"})):y.key==="Enter"?e>=0&&e<o.length&&(r.value=t[e],r.dispatchEvent(new Event("input")),h(),y.preventDefault()):y.key==="Escape"&&h())}),r.addEventListener("blur",()=>setTimeout(h,100))}};async function T(c,r){let s=["Happy","Sad","Angry","Excited","Calm","Anxious","Tired","Motivated","Bored","Grateful","Stressed","Content","Confident","Lonely","Hopeful"];try{let t=c.getAbstractFileByPath((0,R.normalizePath)(r));if(t instanceof R.TFile){let e=(await c.read(t)).split(/\r?\n/);if(e[0].trim()==="---"){let o=1;for(;o<e.length&&e[o].trim()!=="---";)o++;e=e.slice(o+1)}return e.map(o=>o.replace(/<\/?[a-zA-Z][^>]*>/g,"").trim()).filter(o=>o.length>0)}}catch(t){console.error("Failed to load moods file:",t)}return s}var O=class extends x.PluginSettingTab{constructor(r,s){super(r,s),this.plugin=s,s.settingTab=this}display(){let{containerEl:r}=this;r.empty(),r.createEl("h2",{text:"Mood & Energy Plugin Settings"}),r.createEl("h3",{text:"Mood Settings"}),new x.Setting(r).setName("Moods File Path").setDesc("Path to the file containing your moods, one per line (excluding frontmatter). Start typing to see suggestions from your vault.").addText(s=>{s.setPlaceholder("moods.txt").setValue(this.plugin.settings.moodsFilePath).onChange(async t=>{this.plugin.settings.moodsFilePath=t,await this.plugin.saveSettings()}),setTimeout(()=>new L(s.inputEl,this.app),0)}),r.createEl("h3",{text:"Energy Settings"}),new x.Setting(r).setName("Energy Display").setDesc("How to display the energy value: as text, percent, or a progress bar.").addDropdown(s=>s.addOption("text","Text").addOption("percent","Percent").addOption("bar","Progress Bar").setValue(this.plugin.settings.energyDisplay).onChange(async t=>{this.plugin.settings.energyDisplay=t,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.energyDisplay==="bar"&&(new x.Setting(r).setName("Bar Icons").setDesc("Icons for the progress bar, from full to empty (e.g. \u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0 or \u2588\u2593\u2592\u2591)").addText(s=>s.setPlaceholder("\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0").setValue(this.plugin.settings.barIcons).onChange(async t=>{this.plugin.settings.barIcons=t,await this.plugin.saveSettings()})),new x.Setting(r).setName("Bar Icon Count").setDesc("Number of icons in the progress bar (e.g. 5, 7, 10, 20)").addText(s=>s.setPlaceholder("7").setValue(this.plugin.settings.barIconCount.toString()).onChange(async t=>{let n=parseInt(t);!isNaN(n)&&n>0&&(this.plugin.settings.barIconCount=n,await this.plugin.saveSettings())}))),r.createEl("h3",{text:"Output Format Settings"}),new x.Setting(r).setName("Energy Only Output Format").setDesc("Format for energy only output. Use {value} for the energy bar/number.").addText(s=>s.setPlaceholder("Energy: {value}").setValue(this.plugin.settings.energyOnlyFormat).onChange(async t=>{this.plugin.settings.energyOnlyFormat=t,await this.plugin.saveSettings()})),new x.Setting(r).setName("Mood Only Output Format").setDesc("Format for mood only output. Use {value} for the mood.").addText(s=>s.setPlaceholder("{value}").setValue(this.plugin.settings.moodOnlyFormat).onChange(async t=>{this.plugin.settings.moodOnlyFormat=t,await this.plugin.saveSettings()})),new x.Setting(r).setName("Mood + Energy Output Format").setDesc("Format for mood + energy output. Use {mood} and {energy}.").addText(s=>s.setPlaceholder("{mood} | {energy}").setValue(this.plugin.settings.moodAndEnergyFormat).onChange(async t=>{this.plugin.settings.moodAndEnergyFormat=t,await this.plugin.saveSettings()})),new x.Setting(r).setName("Show Mood Ribbon Icon").setDesc("Show a toolbar button for the Mood menu.").addToggle(s=>s.setValue(this.plugin.settings.showMoodRibbon).onChange(async t=>{this.plugin.settings.showMoodRibbon=t,await this.plugin.saveSettings(),this.plugin.reloadRibbonIcons()})),new x.Setting(r).setName("Show Energy Ribbon Icon").setDesc("Show a toolbar button for the Energy slider.").addToggle(s=>s.setValue(this.plugin.settings.showEnergyRibbon).onChange(async t=>{this.plugin.settings.showEnergyRibbon=t,await this.plugin.saveSettings(),this.plugin.reloadRibbonIcons()})),new x.Setting(r).setName("Show Combined Ribbon Icon").setDesc("Show a toolbar button for the combined Mood & Energy modal.").addToggle(s=>s.setValue(this.plugin.settings.showCombinedRibbon).onChange(async t=>{this.plugin.settings.showCombinedRibbon=t,await this.plugin.saveSettings(),this.plugin.reloadRibbonIcons()}))}};var D=require("obsidian");var E=null;function F(c){E&&E!==c&&E.remove(),E=c,document.body.appendChild(c)}function w(c){E===c?(c.remove(),E=null):c.remove()}function k(c,r,s){if(!c||c.length<2||s<1)return r.toString();let t=c.length,n=Math.max(0,Math.min(100,r)),e="";for(let o=0;o<s;o++){let l=100*(o+1)/s,h=n-100*o/s,g=Math.round((1-h/(100/s))*(t-1));n>=l?g=0:n<=100*o/s&&(g=t-1),g=Math.max(0,Math.min(t-1,g)),e+=c[g]}return e}var M=class c{constructor(r){this.selectedMood=null;this.resolveFn=null;this.moods=r}static parseMoodsToTree(r){let s={name:"",level:0,moods:[],sections:[]},t=s,n=[s];for(let e of r)if(/^#+\s/.test(e)){let o=e.match(/^(#+)\s*(.*)$/);if(!o)continue;let l=o[1].length,h=o[2].trim();for(;n.length>0&&n[n.length-1].level>=l;)n.pop();let g=n[n.length-1],v={name:h,level:l,moods:[],sections:[],parent:g};g.sections.push(v),n.push(v),t=v}else e.trim().length>0&&t.moods.push(e.replace(/^[-*]\s*/,""));return s}displayMenu(r){this.modalElement&&w(this.modalElement),this.modalElement=document.createElement("div"),this.modalElement.className="mood-menu",this.modalElement.style.position="fixed",this.modalElement.style.top="50%",this.modalElement.style.left="50%",this.modalElement.style.transform="translate(-50%, -50%)",this.modalElement.style.background="var(--background-secondary)",this.modalElement.style.padding="24px",this.modalElement.style.borderRadius="var(--radius-m)",this.modalElement.style.zIndex="9999",this.modalElement.style.display="flex",this.modalElement.style.flexDirection="column",this.modalElement.style.alignItems="center",this.modalElement.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",this.modalElement.style.maxHeight="80vh",this.modalElement.style.overflow="auto",this.modalElement.style.width=r||"min(700px, 90vw)",this.modalElement.style.minWidth="340px",this.modalElement.style.maxWidth="98vw",this.modalElement.style.border="var(--input-border-width) solid var(--background-modifier-border)";let s=c.parseMoodsToTree(this.moods),t=s,n=[],e=document.createElement("div");e.style.display="grid",e.style.gridTemplateColumns="repeat(auto-fit, minmax(220px, 1fr))",e.style.gap="18px",e.style.width="100%",e.style.marginBottom="18px";let o=document.createElement("div");o.style.display="none",o.style.flexDirection="column",o.style.alignItems="stretch",o.style.width="100%",o.style.marginBottom="18px";let l=document.createElement("button");l.innerText="\u2190 Back",l.className="mod-cta",l.style.marginBottom="12px",l.style.alignSelf="flex-start",l.style.padding="var(--size-4-2) var(--size-4-4)",l.style.borderRadius="var(--radius-s)",l.style.border="var(--input-border-width) solid var(--background-modifier-border)",l.style.background="var(--background-modifier-hover)",l.style.color="var(--text-normal)",l.style.fontWeight="bold",l.style.cursor="pointer",l.onclick=()=>{n.length>0&&(t=n.pop(),h(t))},o.appendChild(l);let h=a=>{if(a===s){e.style.display="grid",o.style.display="none",l.style.display="none",e.innerHTML="";let i=[...a.sections].sort((p,m)=>p.name.localeCompare(m.name)),d=[...a.moods].sort((p,m)=>p.localeCompare(m));if(i.forEach(p=>{let m=document.createElement("div");m.style.display="flex",m.style.flexDirection="column",m.style.alignItems="center",m.style.background="var(--background-modifier-hover)",m.style.borderRadius="var(--radius-m)",m.style.padding="18px 6px 18px 6px",m.style.boxSizing="border-box",m.style.minWidth="0",m.style.cursor="pointer",m.style.transition="background 0.2s",m.onmouseenter=()=>m.style.background="var(--background-modifier-active-hover)",m.onmouseleave=()=>m.style.background="var(--background-modifier-hover)";let u=document.createElement("div");u.innerText=p.name,u.style.fontWeight="bold",u.style.fontSize="1.2rem",u.style.color="var(--text-accent)",m.appendChild(u),m.onclick=()=>{n.push(a),t=p,h(p)},e.appendChild(m)}),i.length>0&&d.length>0){let p=document.createElement("div");p.style.gridColumn="1 / -1",p.style.height="1px",p.style.background="var(--background-modifier-border)",p.style.margin="12px 0",e.appendChild(p)}d.forEach(p=>{let m=document.createElement("button");m.innerText=p,m.className="mod-cta",m.style.padding="var(--size-4-2) var(--size-4-4)",m.style.borderRadius="var(--radius-s)",m.style.border="var(--input-border-width) solid var(--background-modifier-border)",m.style.background="var(--background-modifier-hover)",m.style.color="var(--text-normal)",m.style.fontSize="1rem",m.style.cursor="pointer",m.style.whiteSpace="normal",m.style.overflow="hidden",m.style.wordBreak="normal",m.style.textOverflow="ellipsis",m.style.height="auto",m.style.minHeight="48px",m.style.display="block",m.style.width="100%",m.onmouseenter=()=>m.style.background="var(--background-modifier-active-hover)",m.onmouseleave=()=>m.style.background="var(--background-modifier-hover)",m.onclick=()=>{this.selectMood(p),Array.from(e.querySelectorAll("button")).forEach(u=>u.classList.remove("selected-mood")),m.classList.add("selected-mood"),this.confirmSelection()},e.appendChild(m)})}else{for(e.style.display="none",o.style.display="flex",l.style.display="block";o.childNodes.length>1;)o.removeChild(o.lastChild);let i=[...a.sections].sort((p,m)=>p.name.localeCompare(m.name)),d=[...a.moods].sort((p,m)=>p.localeCompare(m));if(i.length>0){let p=document.createElement("div");p.style.display="grid",p.style.gridTemplateColumns="repeat(auto-fit, minmax(180px, 1fr))",p.style.gap="12px",p.style.width="100%",i.forEach(m=>{let u=document.createElement("div");u.style.display="flex",u.style.flexDirection="column",u.style.alignItems="center",u.style.background="var(--background-modifier-hover)",u.style.borderRadius="var(--radius-m)",u.style.padding="14px 4px 14px 4px",u.style.boxSizing="border-box",u.style.minWidth="0",u.style.cursor="pointer",u.style.transition="background 0.2s",u.onmouseenter=()=>u.style.background="var(--background-modifier-active-hover)",u.onmouseleave=()=>u.style.background="var(--background-modifier-hover)";let C=document.createElement("div");C.innerText=m.name,C.style.fontWeight="bold",C.style.fontSize="1.1rem",C.style.color="var(--text-accent)",u.appendChild(C),u.onclick=()=>{n.push(a),t=m,h(m)},p.appendChild(u)}),o.appendChild(p)}if(i.length>0&&d.length>0){let p=document.createElement("div");p.style.width="100%",p.style.height="1px",p.style.background="var(--background-modifier-border)",p.style.margin="12px 0",o.appendChild(p)}if(d.length>0){let p=document.createElement("div");p.style.display="grid",p.style.gridTemplateColumns="repeat(auto-fit, minmax(100px, 1fr))",p.style.gap="12px",p.style.width="100%",d.forEach(m=>{let u=document.createElement("button");u.innerText=m,u.className="mod-cta",u.style.padding="var(--size-4-2) var(--size-4-4)",u.style.borderRadius="var(--radius-s)",u.style.border="var(--input-border-width) solid var(--background-modifier-border)",u.style.background="var(--background-modifier-hover)",u.style.color="var(--text-normal)",u.style.fontSize="1rem",u.style.cursor="pointer",u.style.whiteSpace="normal",u.style.overflow="hidden",u.style.wordBreak="normal",u.style.textOverflow="ellipsis",u.style.height="auto",u.style.minHeight="48px",u.style.display="block",u.style.width="100%",u.onmouseenter=()=>u.style.background="var(--background-modifier-active-hover)",u.onmouseleave=()=>u.style.background="var(--background-modifier-hover)",u.onclick=()=>{this.selectMood(m),Array.from(p.querySelectorAll("button")).forEach(C=>C.classList.remove("selected-mood")),u.classList.add("selected-mood"),this.confirmSelection()},p.appendChild(u)}),o.appendChild(p)}}};h(s),this.modalElement.appendChild(e),this.modalElement.appendChild(o);let g=document.createElement("div");g.style.display="flex",g.style.gap="12px",g.style.marginTop="10px";let v=document.createElement("button");v.innerText="Okay",v.className="mod-cta",v.style.padding="var(--size-4-2) var(--size-4-4)",v.style.borderRadius="var(--radius-s)",v.style.border="var(--input-border-width) solid var(--background-modifier-border)",v.style.background="var(--interactive-accent)",v.style.color="var(--text-on-accent)",v.style.fontWeight="bold",v.style.cursor="pointer",v.onclick=()=>this.confirmSelection(),g.appendChild(v);let y=document.createElement("button");y.innerText="Cancel",y.className="mod-cta",y.style.padding="var(--size-4-2) var(--size-4-4)",y.style.borderRadius="var(--radius-s)",y.style.border="var(--input-border-width) solid var(--background-modifier-border)",y.style.background="var(--background-modifier-hover)",y.style.color="var(--color-red)",y.style.fontWeight="bold",y.style.cursor="pointer",y.onclick=()=>this.cancelSelection(),g.appendChild(y),this.modalElement.appendChild(g);let f=document.createElement("style");f.innerText=".selected-mood { background: var(--interactive-accent) !important; color: var(--text-on-accent) !important; border: var(--input-border-width) solid var(--background-primary) !important; }",this.modalElement.appendChild(f);let b=a=>{a.key==="Escape"&&(o.style.display==="flex"&&n.length>0?(t=n.pop(),h(t)):(this.closeModal(!1),window.removeEventListener("keydown",b)))};window.addEventListener("keydown",b),F(this.modalElement)}open(){return this.displayMenu(),new Promise(r=>{this.resolveFn=r})}selectMood(r){this.selectedMood=r}confirmSelection(){this.resolveFn&&this.resolveFn(this.selectedMood),this.closeModal(!0)}cancelSelection(){this.resolveFn&&this.resolveFn(null),this.closeModal(!1)}closeModal(r=!1){w(this.modalElement)}renderInline(r,s){r.innerHTML="";let t=c.parseMoodsToTree(this.moods),n=t,e=[],o=document.createElement("div");o.style.display="grid",o.style.gridTemplateColumns="repeat(auto-fit, minmax(220px, 1fr))",o.style.gap="18px",o.style.width="100%",o.style.marginBottom="18px";let l=document.createElement("div");l.style.display="none",l.style.flexDirection="column",l.style.alignItems="stretch",l.style.width="100%",l.style.marginBottom="18px";let h=document.createElement("button");h.innerText="\u2190 Back",h.className="mod-cta",h.style.marginBottom="12px",h.style.alignSelf="flex-start",h.style.padding="var(--size-4-2) var(--size-4-4)",h.style.borderRadius="var(--radius-s)",h.style.border="var(--input-border-width) solid var(--background-modifier-border)",h.style.background="var(--background-modifier-hover)",h.style.color="var(--text-normal)",h.style.fontWeight="bold",h.style.cursor="pointer",h.onclick=()=>{e.length>0&&(n=e.pop(),g(n))},l.appendChild(h);let g=y=>{if(y===t){o.style.display="grid",l.style.display="none",h.style.display="none",o.innerHTML="";let f=[...y.sections].sort((a,i)=>a.name.localeCompare(i.name)),b=[...y.moods].sort((a,i)=>a.localeCompare(i));if(f.forEach(a=>{let i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.alignItems="center",i.style.background="var(--background-modifier-hover)",i.style.borderRadius="var(--radius-m)",i.style.padding="18px 6px 18px 6px",i.style.boxSizing="border-box",i.style.minWidth="0",i.style.cursor="pointer",i.style.transition="background 0.2s",i.onmouseenter=()=>i.style.background="var(--background-modifier-active-hover)",i.onmouseleave=()=>i.style.background="var(--background-modifier-hover)";let d=document.createElement("div");d.innerText=a.name,d.style.fontWeight="bold",d.style.fontSize="1.2rem",d.style.color="var(--text-accent)",i.appendChild(d),i.onclick=()=>{e.push(y),n=a,g(a)},o.appendChild(i)}),f.length>0&&b.length>0){let a=document.createElement("div");a.style.gridColumn="1 / -1",a.style.height="1px",a.style.background="var(--background-modifier-border)",a.style.margin="12px 0",o.appendChild(a)}b.forEach(a=>{let i=document.createElement("button");i.innerText=a,i.className="mod-cta",i.style.padding="var(--size-4-2) var(--size-4-4)",i.style.borderRadius="var(--radius-s)",i.style.border="var(--input-border-width) solid var(--background-modifier-border)",i.style.background="var(--background-modifier-hover)",i.style.color="var(--text-normal)",i.style.fontSize="1rem",i.style.cursor="pointer",i.style.whiteSpace="normal",i.style.overflow="hidden",i.style.wordBreak="normal",i.style.textOverflow="ellipsis",i.style.height="auto",i.style.minHeight="48px",i.style.display="block",i.style.width="100%",i.onmouseenter=()=>i.style.background="var(--background-modifier-active-hover)",i.onmouseleave=()=>i.style.background="var(--background-modifier-hover)",i.onclick=()=>{this.selectedMood=a,Array.from(o.querySelectorAll("button")).forEach(d=>d.classList.remove("selected-mood")),i.classList.add("selected-mood"),s(a)},o.appendChild(i)})}else{for(o.style.display="none",l.style.display="flex",h.style.display="block";l.childNodes.length>1;)l.removeChild(l.lastChild);let f=[...y.sections].sort((a,i)=>a.name.localeCompare(i.name)),b=[...y.moods].sort((a,i)=>a.localeCompare(i));if(f.length>0){let a=document.createElement("div");a.style.display="grid",a.style.gridTemplateColumns="repeat(auto-fit, minmax(180px, 1fr))",a.style.gap="12px",a.style.width="100%",f.forEach(i=>{let d=document.createElement("div");d.style.display="flex",d.style.flexDirection="column",d.style.alignItems="center",d.style.background="var(--background-modifier-hover)",d.style.borderRadius="var(--radius-m)",d.style.padding="14px 4px 14px 4px",d.style.boxSizing="border-box",d.style.minWidth="0",d.style.cursor="pointer",d.style.transition="background 0.2s",d.onmouseenter=()=>d.style.background="var(--background-modifier-active-hover)",d.onmouseleave=()=>d.style.background="var(--background-modifier-hover)";let p=document.createElement("div");p.innerText=i.name,p.style.fontWeight="bold",p.style.fontSize="1.1rem",p.style.color="var(--text-accent)",d.appendChild(p),d.onclick=()=>{e.push(y),n=i,g(i)},a.appendChild(d)}),l.appendChild(a)}if(f.length>0&&b.length>0){let a=document.createElement("div");a.style.width="100%",a.style.height="1px",a.style.background="var(--background-modifier-border)",a.style.margin="12px 0",l.appendChild(a)}if(b.length>0){let a=document.createElement("div");a.style.display="grid",a.style.gridTemplateColumns="repeat(auto-fit, minmax(100px, 1fr))",a.style.gap="12px",a.style.width="100%",b.forEach(i=>{let d=document.createElement("button");d.innerText=i,d.className="mod-cta",d.style.padding="var(--size-4-2) var(--size-4-4)",d.style.borderRadius="var(--radius-s)",d.style.border="var(--input-border-width) solid var(--background-modifier-border)",d.style.background="var(--background-modifier-hover)",d.style.color="var(--text-normal)",d.style.fontSize="1rem",d.style.cursor="pointer",d.style.whiteSpace="normal",d.style.overflow="hidden",d.style.wordBreak="normal",d.style.textOverflow="ellipsis",d.style.height="auto",d.style.minHeight="48px",d.style.display="block",d.style.width="100%",d.onmouseenter=()=>d.style.background="var(--background-modifier-active-hover)",d.onmouseleave=()=>d.style.background="var(--background-modifier-hover)",d.onclick=()=>{this.selectedMood=i,Array.from(a.querySelectorAll("button")).forEach(p=>p.classList.remove("selected-mood")),d.classList.add("selected-mood"),s(i)},a.appendChild(d)}),l.appendChild(a)}}};g(t),r.appendChild(o),r.appendChild(l);let v=document.createElement("style");v.innerText=".selected-mood { background: var(--interactive-accent) !important; color: var(--text-on-accent) !important; border: var(--input-border-width) solid var(--background-primary) !important; }",r.appendChild(v)}};var S=class{constructor(r){this.resolveFn=null;this.selectedValue=50;this.plugin=r,this.createModal()}createModal(){this.modalElement=document.createElement("div"),this.modalElement.className="energy-slider-modal",this.modalElement.style.position="fixed",this.modalElement.style.top="50%",this.modalElement.style.left="50%",this.modalElement.style.transform="translate(-50%, -50%)",this.modalElement.style.background="var(--background-secondary)",this.modalElement.style.padding="24px",this.modalElement.style.borderRadius="var(--radius-m)",this.modalElement.style.zIndex="9999",this.modalElement.style.display="flex",this.modalElement.style.flexDirection="column",this.modalElement.style.alignItems="center",this.modalElement.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",this.modalElement.style.maxHeight="80vh",this.modalElement.style.overflow="auto",this.modalElement.style.minWidth="340px",this.modalElement.style.width="min(420px, 98vw)",this.modalElement.style.border="var(--input-border-width) solid var(--background-modifier-border)",this.modalElement.innerHTML=`
      <div class="slider-container" style="display:flex;flex-direction:column;align-items:center;">
        <input type="range" min="0" max="100" value="50" class="slider" id="energySlider" style="width:200px;">
        <div class="slider-value" id="sliderValue" style="margin-top:8px;color:var(--text-normal);">50</div>
        <div class="energy-preview" id="energyPreview" style="margin-top:8px;color:var(--text-normal);font-family:monospace;font-size:1.2em;"></div>
      </div>
      <div style="display:flex;gap:12px;margin-top:18px;justify-content:center;width:100%;">
        <button id="okayButton" class="mod-cta" style="padding:var(--size-4-2) var(--size-4-4);border-radius:var(--radius-s);border:var(--input-border-width) solid var(--background-modifier-border);background:var(--interactive-accent);color:var(--text-on-accent);font-weight:bold;cursor:pointer;">Okay</button>
        <button id="cancelButton" class="mod-cta" style="padding:var(--size-4-2) var(--size-4-4);border-radius:var(--radius-s);border:var(--input-border-width) solid var(--background-modifier-border);background:var(--background-modifier-hover);color:var(--color-red);font-weight:bold;cursor:pointer;">Cancel</button>
      </div>
    `,this.sliderElement=this.modalElement.querySelector("#energySlider");let r=this.modalElement.querySelector("#sliderValue"),s=this.modalElement.querySelector("#energyPreview"),t=this.modalElement.querySelector("#okayButton"),n=this.modalElement.querySelector("#cancelButton"),e=()=>{let l=this.plugin?.settings||{energyDisplay:"bar",energyFormat:"Energy: {value}",barIcons:"\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0",barIconCount:7,energyOnlyFormat:"Energy: {value}",moodOnlyFormat:"{value}",moodAndEnergyFormat:"{mood} | {energy}"},h=parseInt(this.sliderElement.value),g="";l.energyDisplay==="percent"?g=l.energyOnlyFormat.replace("{value}",`${h}%`):l.energyDisplay==="bar"?g=l.energyOnlyFormat.replace("{value}",k(l.barIcons,h,l.barIconCount)):g=l.energyOnlyFormat.replace("{value}",`${h}`),s.innerText=g};this.sliderElement.addEventListener("input",()=>{this.selectedValue=parseInt(this.sliderElement.value),r.textContent=this.selectedValue.toString(),e()}),e(),t.addEventListener("click",()=>{this.closeModal(),this.resolveFn&&this.resolveFn(this.selectedValue)}),n.addEventListener("click",()=>{this.closeModal(),this.resolveFn&&this.resolveFn(null)});let o=l=>{l.key==="Escape"&&(this.closeModal(),window.removeEventListener("keydown",o))};window.addEventListener("keydown",o)}open(){return F(this.modalElement),new Promise(r=>{this.resolveFn=r})}closeModal(){w(this.modalElement)}renderInline(r,s){r.innerHTML="";let t=document.createElement("div");t.className="energy-slider-inline",t.style.background="var(--background-secondary)",t.style.padding="24px",t.style.borderRadius="var(--radius-m)",t.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",t.style.border="var(--input-border-width) solid var(--background-modifier-border)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.width="100%";let n=document.createElement("div");n.innerText="Energy Level:",n.style.color="var(--text-normal, #fff)",n.style.marginBottom="8px";let e=document.createElement("input");e.type="range",e.min="0",e.max="100",e.value=this.selectedValue.toString(),e.className="slider",e.style.width="220px",e.style.margin="0 0 0 0";let o=document.createElement("div");o.innerText=this.selectedValue.toString(),o.style.color="var(--text-normal, #fff)",o.style.marginTop="8px";let l=document.createElement("div");l.style.marginTop="8px",l.style.color="var(--text-normal, #fff)",l.style.fontFamily="monospace",l.style.fontSize="1.2em";let h=()=>{let g=this.plugin?.settings||{energyDisplay:"bar",energyFormat:"Energy: {value}",barIcons:"\u28FF\u28F7\u28F6\u28E6\u28E4\u28C4\u28C0",barIconCount:7,energyOnlyFormat:"Energy: {value}",moodOnlyFormat:"{value}",moodAndEnergyFormat:"{mood} | {energy}"},v=parseInt(e.value),y="";g.energyDisplay==="percent"?y=g.energyOnlyFormat.replace("{value}",`${v}%`):g.energyDisplay==="bar"?y=g.energyOnlyFormat.replace("{value}",k(g.barIcons,v,g.barIconCount)):y=g.energyOnlyFormat.replace("{value}",`${v}`),l.innerText=y};e.oninput=()=>{this.selectedValue=parseInt(e.value),o.innerText=e.value,h(),s(this.selectedValue)},h(),e.style.appearance="none",e.style.height="6px",e.style.background="var(--background-modifier-border)",e.style.borderRadius="4px",e.style.outline="none",e.style.marginBottom="0",e.style.marginTop="0",e.style.marginLeft="0",e.style.marginRight="0",e.style.boxShadow="0 1px 2px rgba(0,0,0,0.04)",e.style.setProperty("::-webkit-slider-thumb","background: var(--interactive-accent); border-radius: 50%; width: 18px; height: 18px; cursor: pointer; border: 2px solid var(--background-primary);"),t.appendChild(n),t.appendChild(e),t.appendChild(o),t.appendChild(l),r.appendChild(t)}};var P=require("obsidian");async function V(c){let r=await T(c.app.vault,c.settings.moodsFilePath),s=new M(r),t=null,n=50,e=document.createElement("div");e.className="mood-energy-modal",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.background="var(--background-secondary)",e.style.padding="24px",e.style.borderRadius="var(--radius-m)",e.style.zIndex="9999",e.style.display="flex",e.style.flexDirection=window.innerWidth<600?"column":"row",e.style.alignItems="stretch",e.style.boxShadow="0 4px 32px var(--background-modifier-box-shadow)",e.style.maxHeight=window.innerWidth<600?"98vh":"80vh",e.style.overflow="visible",e.style.width=window.innerWidth<600?"98vw":"min(900px, 98vw)",e.style.minWidth=window.innerWidth<600?"0":"340px",e.style.maxWidth="98vw",e.style.border="var(--input-border-width) solid var(--background-modifier-border)";let o=document.createElement("div");o.style.flex="1 1 0",o.style.overflowY="auto",o.style.marginRight=window.innerWidth<600?"0":"32px",o.style.background="var(--background-modifier-hover, rgba(255,255,255,0.01))",o.style.borderRadius="8px",o.style.display="flex",o.style.flexDirection="column",o.style.minWidth=window.innerWidth<600?"0":"260px",o.style.width=window.innerWidth<600?"100%":"";let l=document.createElement("div");l.style.display="flex",l.style.flexDirection="column",l.style.alignItems="center",l.style.justifyContent="flex-start",l.style.width=window.innerWidth<600?"100%":"320px",l.style.minWidth=window.innerWidth<600?"0":"220px",l.style.maxWidth=window.innerWidth<600?"100vw":"340px",l.style.background="var(--background-modifier-hover)",l.style.borderRadius="var(--radius-m)",l.style.padding=window.innerWidth<600?"12px":"18px 18px 18px 18px",l.style.boxSizing="border-box",l.style.height="100%",s.renderInline(o,b=>{t=b}),new S(c).renderInline(l,b=>{n=b});let g=document.createElement("div");g.style.display="flex",g.style.gap="12px",g.style.marginTop="18px",g.style.justifyContent="center",g.style.width="100%";let v=document.createElement("button");v.innerText="Okay",v.className="mod-cta",v.onclick=()=>{let b=c.app.workspace.getActiveViewOfType(P.MarkdownView)?.editor;if(b&&t&&n!==null){let a=c.settings,i="";a.energyDisplay==="percent"?i=a.energyOnlyFormat.replace("{value}",`${n}%`):a.energyDisplay==="bar"?i=a.energyOnlyFormat.replace("{value}",k(a.barIcons,n,a.barIconCount)):i=a.energyOnlyFormat.replace("{value}",`${n}`);let p=(a.moodAndEnergyFormat||"{mood} | {energy}").replace("{mood}",t).replace("{energy}",i);typeof b.focus=="function"&&b.focus(),b.replaceSelection(p)}w(e)};let y=document.createElement("button");y.innerText="Cancel",y.className="mod-cta",y.style.padding="var(--size-4-2) var(--size-4-4)",y.style.borderRadius="var(--radius-s)",y.style.border="var(--input-border-width) solid var(--background-modifier-border)",y.style.background="var(--background-modifier-hover)",y.style.color="var(--color-red)",y.style.fontWeight="bold",y.style.cursor="pointer",y.onclick=()=>w(e),g.appendChild(v),g.appendChild(y),l.appendChild(g);let f=b=>{b.key==="Escape"&&(w(e),window.removeEventListener("keydown",f))};window.addEventListener("keydown",f),e.appendChild(o),e.appendChild(l),F(e)}async function W(c){let r=await T(c.app.vault,c.settings.moodsFilePath),t=await new M(r).open();if(t){let n=c.app.workspace.getActiveViewOfType(D.MarkdownView)?.editor;if(n){let o=(c.settings.moodOnlyFormat||"{value}").replace("{value}",t);n.focus(),n.replaceSelection(o)}}}async function H(c){let s=await new S(c).open();if(s!==null){let t=c.app.workspace.getActiveViewOfType(D.MarkdownView)?.editor;if(t){let n="",e=c.settings;e.energyDisplay==="percent"?n=e.energyOnlyFormat.replace("{value}",`${s}%`):e.energyDisplay==="bar"?n=e.energyOnlyFormat.replace("{value}",k(e.barIcons,s,e.barIconCount)):n=e.energyOnlyFormat.replace("{value}",`${s}`),t.focus(),t.replaceSelection(n)}}}async function N(c){await V(c)}function $(c){function r(){return!E}c.addCommand({id:"insert-mood",name:"Insert Mood",hotkeys:[{modifiers:["Alt"],key:"6"}],callback:async()=>{if(!r())return;let s=await T(c.app.vault,c.settings.moodsFilePath),n=await new M(s).open();if(n){let e=c.app.workspace.getActiveViewOfType(D.MarkdownView)?.editor;if(e){let l=(c.settings.moodOnlyFormat||"{value}").replace("{value}",n);e.replaceSelection(l),e.focus&&e.focus()}}}}),c.addCommand({id:"insert-energy-level",name:"Insert Energy Level",hotkeys:[{modifiers:["Alt"],key:"5"}],callback:async()=>{if(!r())return;let t=await new S(c).open();if(t!==null){let n=c.app.workspace.getActiveViewOfType(D.MarkdownView)?.editor;if(n){let e="",o=c.settings;o.energyDisplay==="percent"?e=o.energyOnlyFormat.replace("{value}",`${t}%`):o.energyDisplay==="bar"?e=o.energyOnlyFormat.replace("{value}",k(o.barIcons,t,o.barIconCount)):e=o.energyOnlyFormat.replace("{value}",`${t}`),n.replaceSelection(e),n.focus&&n.focus()}}}}),c.addCommand({id:"insert-mood-and-energy",name:"Insert Mood and Energy Level",hotkeys:[{modifiers:["Alt"],key:"7"}],callback:async()=>{r()&&await N(c)}})}var z=class extends I.Plugin{constructor(s,t){super(s,t);this.settingTab=null;this.ribbonIcons=[];this.settings=B}reloadRibbonIcons(){if(this.ribbonIcons.forEach(s=>s.remove()),this.ribbonIcons=[],this.settings.showMoodRibbon){let s=this.addRibbonIcon("smile","Open Mood Menu",async()=>{let t=this.app.workspace.getActiveViewOfType(I.MarkdownView)?.editor;t&&t.focus(),await W(this)});this.ribbonIcons.push(s)}if(this.settings.showEnergyRibbon){let s=this.addRibbonIcon("activity","Open Energy Slider",async()=>{let t=this.app.workspace.getActiveViewOfType(I.MarkdownView)?.editor;t&&t.focus(),await H(this)});this.ribbonIcons.push(s)}if(this.settings.showCombinedRibbon){let s=this.addRibbonIcon("bar-chart-2","Open Mood & Energy Modal",async()=>{let t=this.app.workspace.getActiveViewOfType(I.MarkdownView)?.editor;t&&t.focus(),await N(this)});this.ribbonIcons.push(s)}}async onload(){this.settings=Object.assign({},B,await this.loadData?.()),await this.saveSettings(),this.addSettingTab(new O(this.app,this)),$(this),await this.reloadRibbonIcons()}async saveSettings(){await this.saveData?.(this.settings)}onunload(){this.ribbonIcons.forEach(s=>s.remove()),this.ribbonIcons=[]}};
//# sourceMappingURL=main.js.map
